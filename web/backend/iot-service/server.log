🏔️  滑坡监测IoT服务已启动
📡 端口: 5100
🌐 健康检查: http://localhost:5100/health
📊 服务信息: http://localhost:5100/info
📨 IoT数据接收: http://localhost:5100/iot/huawei
⏰ 启动时间: 2025-07-18T12:28:49.412Z
=====================================
✅ 设备映射缓存初始化完成，加载了 1 个设备映射
✅ 设备映射器初始化成功
🔄 启动数据处理器...
📱 初始化设备信息...
✅ 设备注册成功: 龙门滑坡监测站3 (6_rk2206)
📍 设备位置更新: 龙门滑坡监测站5 (6_rk2206) (22.817, 108.3669)
✅ 初始化了 1 个设备
🔄 启动实时数据处理...
✅ 数据处理器启动成功
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:29:08.715Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T122908Z",
  "event_time_ms": "2025-07-18T12:29:08.555Z",
  "request_id": "703b1548-823a-49cd-820d-1aed873da000",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.48088836669922,
            "illumination": 74.16666412353516,
            "humidity": 34.72800827026367,
            "acceleration_x": 9,
            "acceleration_y": 35,
            "acceleration_z": 865,
            "gyroscope_x": -154,
            "gyroscope_y": 51,
            "gyroscope_z": -127,
            "mpu_temperature": 31.48088836669922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8659984469413757,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1281,
            "angle_x": 2.31854772567749,
            "angle_y": -0.6466517448425293,
            "angle_z": 2.407035943926087
          },
          "event_time": "20250718T122908Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.48088836669922,
  illumination: 74.16666412353516,
  humidity: 34.72800827026367,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 865,
  gyroscope_x: -154,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.48088836669922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8659984469413757,
  risk_level: 0,
  alarm_active: false,
  uptime: 1281,
  angle_x: 2.31854772567749,
  angle_y: -0.6466517448425293,
  angle_z: 2.407035943926087
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:29:08.000Z',
  temperature: 31.48088836669922,
  humidity: 34.72800827026367,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 865,
  gyroscope_x: -154,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.48088836669922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.7545841634337,
  gyroscope_total: 206.0242704149198,
  risk_level: 0,
  alarm_active: false,
  uptime: 1281,
  angle_x: 2.31854772567749,
  angle_y: -0.6466517448425293,
  angle_z: 2.407035943926087
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13352

⏱️  处理完成，耗时: 1055ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:29:38.902Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T122938Z",
  "event_time_ms": "2025-07-18T12:29:38.728Z",
  "request_id": "c2f0f87f-0a70-44b6-8076-6aa1f159fc80",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.494239807128906,
            "illumination": 74.16666412353516,
            "humidity": 35.12168884277344,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 868,
            "gyroscope_x": -151,
            "gyroscope_y": 43,
            "gyroscope_z": -125,
            "mpu_temperature": 31.494239807128906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8689420223236084,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1311,
            "angle_x": 2.1334779262542725,
            "angle_y": -0.6363251209259033,
            "angle_z": 2.2263507633200113
          },
          "event_time": "20250718T122938Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.494239807128906,
  illumination: 74.16666412353516,
  humidity: 35.12168884277344,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 43,
  gyroscope_z: -125,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8689420223236084,
  risk_level: 0,
  alarm_active: false,
  uptime: 1311,
  angle_x: 2.1334779262542725,
  angle_y: -0.6363251209259033,
  angle_z: 2.2263507633200113
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:29:38.000Z',
  temperature: 31.494239807128906,
  humidity: 35.12168884277344,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 43,
  gyroscope_z: -125,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.6362875219985,
  gyroscope_total: 200.6863224038948,
  risk_level: 0,
  alarm_active: false,
  uptime: 1311,
  angle_x: 2.1334779262542725,
  angle_y: -0.6363251209259033,
  angle_z: 2.2263507633200113
}
✅ 数据插入成功
插入的记录ID: 13353

⏱️  处理完成，耗时: 982ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:30:09.020Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123008Z",
  "event_time_ms": "2025-07-18T12:30:08.907Z",
  "request_id": "f9b121f1-e119-4359-ad99-417c687bd099",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 80.8333282470703,
            "humidity": 34.99809265136719,
            "acceleration_x": 10,
            "acceleration_y": 35,
            "acceleration_z": 866,
            "gyroscope_x": -152,
            "gyroscope_y": 51,
            "gyroscope_z": -128,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867466151714325,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1341,
            "angle_x": 2.314622640609741,
            "angle_y": -0.6697652339935303,
            "angle_z": 2.4095774395295164
          },
          "event_time": "20250718T123008Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 80.8333282470703,
  humidity: 34.99809265136719,
  acceleration_x: 10,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867466151714325,
  risk_level: 0,
  alarm_active: false,
  uptime: 1341,
  angle_x: 2.314622640609741,
  angle_y: -0.6697652339935303,
  angle_z: 2.4095774395295164
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:30:08.000Z',
  temperature: 31.507591247558594,
  humidity: 34.99809265136719,
  illumination: 80.8333282470703,
  acceleration_x: 10,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7646739455871,
  gyroscope_total: 205.15603817582362,
  risk_level: 0,
  alarm_active: false,
  uptime: 1341,
  angle_x: 2.314622640609741,
  angle_y: -0.6697652339935303,
  angle_z: 2.4095774395295164
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13354

⏱️  处理完成，耗时: 513ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:30:39.058Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123038Z",
  "event_time_ms": "2025-07-18T12:30:38.898Z",
  "request_id": "66b56a1e-bc3b-4bf4-97dd-c2e9ae2878fc",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 80.8333282470703,
            "humidity": 34.81345748901367,
            "acceleration_x": 7,
            "acceleration_y": 34,
            "acceleration_z": 869,
            "gyroscope_x": -151,
            "gyroscope_y": 48,
            "gyroscope_z": -124,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.870350956916809,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1371,
            "angle_x": 2.2747769355773926,
            "angle_y": -0.5227571725845337,
            "angle_z": 2.3340705148138623
          },
          "event_time": "20250718T123038Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 80.8333282470703,
  humidity: 34.81345748901367,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -151,
  gyroscope_y: 48,
  gyroscope_z: -124,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.870350956916809,
  risk_level: 0,
  alarm_active: false,
  uptime: 1371,
  angle_x: 2.2747769355773926,
  angle_y: -0.5227571725845337,
  angle_z: 2.3340705148138623
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:30:38.000Z',
  temperature: 31.507591247558594,
  humidity: 34.81345748901367,
  illumination: 80.8333282470703,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -151,
  gyroscope_y: 48,
  gyroscope_z: -124,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.693049299579,
  gyroscope_total: 201.19890655766497,
  risk_level: 0,
  alarm_active: false,
  uptime: 1371,
  angle_x: 2.2747769355773926,
  angle_y: -0.5227571725845337,
  angle_z: 2.3340705148138623
}
✅ 数据插入成功
插入的记录ID: 13355

⏱️  处理完成，耗时: 383ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:31:09.099Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123108Z",
  "event_time_ms": "2025-07-18T12:31:08.977Z",
  "request_id": "bd046573-3619-43a5-8054-b9177edfdf65",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 80.8333282470703,
            "humidity": 35.2498664855957,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 864,
            "gyroscope_x": -153,
            "gyroscope_y": 45,
            "gyroscope_z": -131,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8655452132225037,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1401,
            "angle_x": 2.1903727054595947,
            "angle_y": -0.5822376608848572,
            "angle_z": 2.2664362516018524
          },
          "event_time": "20250718T123108Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 80.8333282470703,
  humidity: 35.2498664855957,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 864,
  gyroscope_x: -153,
  gyroscope_y: 45,
  gyroscope_z: -131,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8655452132225037,
  risk_level: 0,
  alarm_active: false,
  uptime: 1401,
  angle_x: 2.1903727054595947,
  angle_y: -0.5822376608848572,
  angle_z: 2.2664362516018524
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:31:08.000Z',
  temperature: 31.52094268798828,
  humidity: 35.2498664855957,
  illumination: 80.8333282470703,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 864,
  gyroscope_x: -153,
  gyroscope_y: 45,
  gyroscope_z: -131,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.6669879207833,
  gyroscope_total: 206.3855615104894,
  risk_level: 0,
  alarm_active: false,
  uptime: 1401,
  angle_x: 2.1903727054595947,
  angle_y: -0.5822376608848572,
  angle_z: 2.2664362516018524
}
✅ 数据插入成功
插入的记录ID: 13356

⏱️  处理完成，耗时: 537ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 100
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:31:39.627Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123139Z",
  "event_time_ms": "2025-07-18T12:31:39.447Z",
  "request_id": "e619965c-6821-45be-92ae-14ca124a06af",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 74.16666412353516,
            "humidity": 35.30937576293945,
            "acceleration_x": 11,
            "acceleration_y": 35,
            "acceleration_z": 866,
            "gyroscope_x": -149,
            "gyroscope_y": 50,
            "gyroscope_z": -129,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867278814315796,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1432,
            "angle_x": 2.3716211318969727,
            "angle_y": -0.782945215702057,
            "angle_z": 2.4975167675214953
          },
          "event_time": "20250718T123139Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 74.16666412353516,
  humidity: 35.30937576293945,
  acceleration_x: 11,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -149,
  gyroscope_y: 50,
  gyroscope_z: -129,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867278814315796,
  risk_level: 0,
  alarm_active: false,
  uptime: 1432,
  angle_x: 2.3716211318969727,
  angle_y: -0.782945215702057,
  angle_z: 2.4975167675214953
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:31:39.000Z',
  temperature: 31.536964416503906,
  humidity: 35.30937576293945,
  illumination: 74.16666412353516,
  acceleration_x: 11,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -149,
  gyroscope_y: 50,
  gyroscope_z: -129,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.776787875633,
  gyroscope_total: 203.32732231552157,
  risk_level: 0,
  alarm_active: false,
  uptime: 1432,
  angle_x: 2.3716211318969727,
  angle_y: -0.782945215702057,
  angle_z: 2.4975167675214953
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13357

⏱️  处理完成，耗时: 469ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:32:09.602Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123209Z",
  "event_time_ms": "2025-07-18T12:32:09.445Z",
  "request_id": "ce3d1987-280e-42fb-9168-24e0943eb838",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 35.01640319824219,
            "acceleration_x": 7,
            "acceleration_y": 33,
            "acceleration_z": 869,
            "gyroscope_x": -149,
            "gyroscope_y": 54,
            "gyroscope_z": -125,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8700427412986755,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1462,
            "angle_x": 2.179044246673584,
            "angle_y": -0.4665938913822174,
            "angle_z": 2.228439743057112
          },
          "event_time": "20250718T123209Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 35.01640319824219,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 869,
  gyroscope_x: -149,
  gyroscope_y: 54,
  gyroscope_z: -125,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8700427412986755,
  risk_level: 0,
  alarm_active: false,
  uptime: 1462,
  angle_x: 2.179044246673584,
  angle_y: -0.4665938913822174,
  angle_z: 2.228439743057112
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:32:09.000Z',
  temperature: 31.56633758544922,
  humidity: 35.01640319824219,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 869,
  gyroscope_x: -149,
  gyroscope_y: 54,
  gyroscope_z: -125,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.654529109117,
  gyroscope_total: 201.84647631306325,
  risk_level: 0,
  alarm_active: false,
  uptime: 1462,
  angle_x: 2.179044246673584,
  angle_y: -0.4665938913822174,
  angle_z: 2.228439743057112
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13358

⏱️  处理完成，耗时: 515ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:32:39.605Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123239Z",
  "event_time_ms": "2025-07-18T12:32:39.425Z",
  "request_id": "f64413a2-8ebd-4cf9-a3e9-329d275e876f",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 35.01640319824219,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 864,
            "gyroscope_x": -154,
            "gyroscope_y": 56,
            "gyroscope_z": -127,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8651123046875,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1492,
            "angle_x": 2.296649932861328,
            "angle_y": -0.5340222716331482,
            "angle_z": 2.35791872224472
          },
          "event_time": "20250718T123239Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 35.01640319824219,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 864,
  gyroscope_x: -154,
  gyroscope_y: 56,
  gyroscope_z: -127,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8651123046875,
  risk_level: 0,
  alarm_active: false,
  uptime: 1492,
  angle_x: 2.296649932861328,
  angle_y: -0.5340222716331482,
  angle_z: 2.35791872224472
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:32:39.000Z',
  temperature: 31.56633758544922,
  humidity: 35.01640319824219,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 864,
  gyroscope_x: -154,
  gyroscope_y: 56,
  gyroscope_z: -127,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.7057302921035,
  gyroscope_total: 207.31859540330674,
  risk_level: 0,
  alarm_active: false,
  uptime: 1492,
  angle_x: 2.296649932861328,
  angle_y: -0.5340222716331482,
  angle_z: 2.35791872224472
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13359

⏱️  处理完成，耗时: 527ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:33:09.926Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123309Z",
  "event_time_ms": "2025-07-18T12:33:09.767Z",
  "request_id": "9e6c51db-7175-4d37-bfda-9eb337c22592",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 74.16666412353516,
            "humidity": 34.92790222167969,
            "acceleration_x": 4,
            "acceleration_y": 34,
            "acceleration_z": 871,
            "gyroscope_x": -153,
            "gyroscope_y": 43,
            "gyroscope_z": -122,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.872641146183014,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1522,
            "angle_x": 2.2607827186584473,
            "angle_y": -0.3208465874195099,
            "angle_z": 2.2834362337589864
          },
          "event_time": "20250718T123309Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 74.16666412353516,
  humidity: 34.92790222167969,
  acceleration_x: 4,
  acceleration_y: 34,
  acceleration_z: 871,
  gyroscope_x: -153,
  gyroscope_y: 43,
  gyroscope_z: -122,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.872641146183014,
  risk_level: 0,
  alarm_active: false,
  uptime: 1522,
  angle_x: 2.2607827186584473,
  angle_y: -0.3208465874195099,
  angle_z: 2.2834362337589864
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:33:09.000Z',
  temperature: 31.536964416503906,
  humidity: 34.92790222167969,
  illumination: 74.16666412353516,
  acceleration_x: 4,
  acceleration_y: 34,
  acceleration_z: 871,
  gyroscope_x: -153,
  gyroscope_y: 43,
  gyroscope_z: -122,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 871.6725302543381,
  gyroscope_total: 200.35468549549822,
  risk_level: 0,
  alarm_active: false,
  uptime: 1522,
  angle_x: 2.2607827186584473,
  angle_y: -0.3208465874195099,
  angle_z: 2.2834362337589864
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13360

⏱️  处理完成，耗时: 549ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

❌ 更新设备活跃时间失败: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:12637:11\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async DataProcessor.updateDeviceActivity (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:180:25)\n' +
    '    at async DataProcessor.processNewData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:162:7)\n' +
    '    at async Object.callback (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:148:11)',
  hint: '',
  code: ''
}
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:33:40.130Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123339Z",
  "event_time_ms": "2025-07-18T12:33:39.965Z",
  "request_id": "845b47f9-b201-41b6-b46e-cf00d947e18a",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 35.01640319824219,
            "acceleration_x": 8,
            "acceleration_y": 31,
            "acceleration_z": 867,
            "gyroscope_x": -153,
            "gyroscope_y": 51,
            "gyroscope_z": -128,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868424355983734,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1552,
            "angle_x": 2.110572099685669,
            "angle_y": -0.5319191217422485,
            "angle_z": 2.17656898352582
          },
          "event_time": "20250718T123339Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 35.01640319824219,
  acceleration_x: 8,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868424355983734,
  risk_level: 0,
  alarm_active: false,
  uptime: 1552,
  angle_x: 2.110572099685669,
  angle_y: -0.5319191217422485,
  angle_z: 2.17656898352582
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:33:39.000Z',
  temperature: 31.56633758544922,
  humidity: 35.01640319824219,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.5909174259491,
  gyroscope_total: 205.89803301634527,
  risk_level: 0,
  alarm_active: false,
  uptime: 1552,
  angle_x: 2.110572099685669,
  angle_y: -0.5319191217422485,
  angle_z: 2.17656898352582
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13361

⏱️  处理完成，耗时: 524ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 200
🔍 检查设备离线状态...
🔄 处理 100 条历史数据...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备 (77035712) (179796分钟)
📵 设备离线: 上坪监测设备 (vice_006) (179158分钟)
📵 设备离线: 下湾监测设备 (vice_007) (179153分钟)
📵 设备离线: 前岗监测设备 (vice_008) (179148分钟)
📵 设备离线: 上坪监测设备1 (t_device) (68997分钟)
📵 设备离线: 龙门滑坡监测站 (5分钟)
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:34:10.239Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123410Z",
  "event_time_ms": "2025-07-18T12:34:10.087Z",
  "request_id": "a9f40422-c491-4ee2-afe6-40db176629fb",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 74.16666412353516,
            "humidity": 34.87449264526367,
            "acceleration_x": 8,
            "acceleration_y": 35,
            "acceleration_z": 862,
            "gyroscope_x": -151,
            "gyroscope_y": 45,
            "gyroscope_z": -128,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8630860447883606,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1582,
            "angle_x": 2.3750381469726562,
            "angle_y": -0.5515278577804565,
            "angle_z": 2.4382348487139645
          },
          "event_time": "20250718T123410Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 74.16666412353516,
  humidity: 34.87449264526367,
  acceleration_x: 8,
  acceleration_y: 35,
  acceleration_z: 862,
  gyroscope_x: -151,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8630860447883606,
  risk_level: 0,
  alarm_active: false,
  uptime: 1582,
  angle_x: 2.3750381469726562,
  angle_y: -0.5515278577804565,
  angle_z: 2.4382348487139645
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:34:10.000Z',
  temperature: 31.550315856933594,
  humidity: 34.87449264526367,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 35,
  acceleration_z: 862,
  gyroscope_x: -151,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 862.7473558348354,
  gyroscope_total: 203.00246303924493,
  risk_level: 0,
  alarm_active: false,
  uptime: 1582,
  angle_x: 2.3750381469726562,
  angle_y: -0.5515278577804565,
  angle_z: 2.4382348487139645
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13362

⏱️  处理完成，耗时: 605ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

❌ 更新风险趋势失败: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:12637:11\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async DataProcessor.updateRiskTrends (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:356:27)\n' +
    '    at async DataProcessor.processNewData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:168:7)\n' +
    '    at async DataProcessor.processHistoricalData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:398:11)',
  hint: '',
  code: ''
}
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:34:40.142Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123440Z",
  "event_time_ms": "2025-07-18T12:34:40.033Z",
  "request_id": "8e7adf24-5b3e-4c3c-abe6-66fb942c79b9",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 73.3333282470703,
            "humidity": 34.67765426635742,
            "acceleration_x": 8,
            "acceleration_y": 32,
            "acceleration_z": 867,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -129,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8685725331306458,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1612,
            "angle_x": 2.15050196647644,
            "angle_y": -0.556017518043518,
            "angle_z": 2.2212190770363716
          },
          "event_time": "20250718T123440Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 73.3333282470703,
  humidity: 34.67765426635742,
  acceleration_x: 8,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -129,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8685725331306458,
  risk_level: 0,
  alarm_active: false,
  uptime: 1612,
  angle_x: 2.15050196647644,
  angle_y: -0.556017518043518,
  angle_z: 2.2212190770363716
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:34:40.000Z',
  temperature: 31.56633758544922,
  humidity: 34.67765426635742,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -129,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6272241003045,
  gyroscope_total: 205.8688903161427,
  risk_level: 0,
  alarm_active: false,
  uptime: 1612,
  angle_x: 2.15050196647644,
  angle_y: -0.556017518043518,
  angle_z: 2.2212190770363716
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13363

⏱️  处理完成，耗时: 1155ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:35:10.316Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123510Z",
  "event_time_ms": "2025-07-18T12:35:10.188Z",
  "request_id": "5d55cdfe-6905-4f49-922d-39fb7e8636f1",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 74.16666412353516,
            "humidity": 34.87449264526367,
            "acceleration_x": 9,
            "acceleration_y": 34,
            "acceleration_z": 866,
            "gyroscope_x": -151,
            "gyroscope_y": 54,
            "gyroscope_z": -132,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8670759797096252,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1642,
            "angle_x": 2.2914459705352783,
            "angle_y": -0.6135427355766296,
            "angle_z": 2.37216342697151
          },
          "event_time": "20250718T123510Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 74.16666412353516,
  humidity: 34.87449264526367,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -151,
  gyroscope_y: 54,
  gyroscope_z: -132,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8670759797096252,
  risk_level: 0,
  alarm_active: false,
  uptime: 1642,
  angle_x: 2.2914459705352783,
  angle_y: -0.6135427355766296,
  angle_z: 2.37216342697151
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:35:10.000Z',
  temperature: 31.550315856933594,
  humidity: 34.87449264526367,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -151,
  gyroscope_y: 54,
  gyroscope_z: -132,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.713908968813,
  gyroscope_total: 207.70411647341032,
  risk_level: 0,
  alarm_active: false,
  uptime: 1642,
  angle_x: 2.2914459705352783,
  angle_y: -0.6135427355766296,
  angle_z: 2.37216342697151
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13364

⏱️  处理完成，耗时: 627ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:35:40.454Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123540Z",
  "event_time_ms": "2025-07-18T12:35:40.327Z",
  "request_id": "7e02c115-5f03-4826-92c3-13efd4deeefe",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 74.16666412353516,
            "humidity": 35.02861022949219,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 865,
            "gyroscope_x": -156,
            "gyroscope_y": 48,
            "gyroscope_z": -126,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8661773800849915,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1672,
            "angle_x": 2.2291767597198486,
            "angle_y": -0.5737468004226685,
            "angle_z": 2.301828494278045
          },
          "event_time": "20250718T123540Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 74.16666412353516,
  humidity: 35.02861022949219,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 865,
  gyroscope_x: -156,
  gyroscope_y: 48,
  gyroscope_z: -126,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8661773800849915,
  risk_level: 0,
  alarm_active: false,
  uptime: 1672,
  angle_x: 2.2291767597198486,
  angle_y: -0.5737468004226685,
  angle_z: 2.301828494278045
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:35:40.000Z',
  temperature: 31.52094268798828,
  humidity: 35.02861022949219,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 865,
  gyroscope_x: -156,
  gyroscope_y: 48,
  gyroscope_z: -126,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.6662174302518,
  gyroscope_total: 206.194083329275,
  risk_level: 0,
  alarm_active: false,
  uptime: 1672,
  angle_x: 2.2291767597198486,
  angle_y: -0.5737468004226685,
  angle_z: 2.301828494278045
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13365

⏱️  处理完成，耗时: 1144ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:36:10.955Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123610Z",
  "event_time_ms": "2025-07-18T12:36:10.797Z",
  "request_id": "220e0cbc-24bf-4e26-ad42-4b040612d67b",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 73.3333282470703,
            "humidity": 35.12932205200195,
            "acceleration_x": 4,
            "acceleration_y": 32,
            "acceleration_z": 866,
            "gyroscope_x": -158,
            "gyroscope_y": 41,
            "gyroscope_z": -131,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8670842051506042,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1702,
            "angle_x": 2.162266969680786,
            "angle_y": -0.298665076494217,
            "angle_z": 2.182796205808006
          },
          "event_time": "20250718T123610Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 73.3333282470703,
  humidity: 35.12932205200195,
  acceleration_x: 4,
  acceleration_y: 32,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 41,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8670842051506042,
  risk_level: 0,
  alarm_active: false,
  uptime: 1702,
  angle_x: 2.162266969680786,
  angle_y: -0.298665076494217,
  angle_z: 2.182796205808006
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:36:10.000Z',
  temperature: 31.56633758544922,
  humidity: 35.12932205200195,
  illumination: 73.3333282470703,
  acceleration_x: 4,
  acceleration_y: 32,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 41,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6002538656448,
  gyroscope_total: 209.29882942816474,
  risk_level: 0,
  alarm_active: false,
  uptime: 1702,
  angle_x: 2.162266969680786,
  angle_y: -0.298665076494217,
  angle_z: 2.182796205808006
}
✅ 历史数据处理完成，最新ID: 300
✅ 数据插入成功
插入的记录ID: 13366

⏱️  处理完成，耗时: 479ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:36:41.375Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123641Z",
  "event_time_ms": "2025-07-18T12:36:41.211Z",
  "request_id": "9b784310-ddfb-475f-97c2-7efa43e3dd17",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.60906219482422,
            "illumination": 74.16666412353516,
            "humidity": 34.87907409667969,
            "acceleration_x": 9,
            "acceleration_y": 35,
            "acceleration_z": 868,
            "gyroscope_x": -151,
            "gyroscope_y": 53,
            "gyroscope_z": -135,
            "mpu_temperature": 31.60906219482422,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.869562268257141,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1732,
            "angle_x": 2.365389585494995,
            "angle_y": -0.5957193970680237,
            "angle_z": 2.43925183021583
          },
          "event_time": "20250718T123641Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.60906219482422,
  illumination: 74.16666412353516,
  humidity: 34.87907409667969,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 53,
  gyroscope_z: -135,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.869562268257141,
  risk_level: 0,
  alarm_active: false,
  uptime: 1732,
  angle_x: 2.365389585494995,
  angle_y: -0.5957193970680237,
  angle_z: 2.43925183021583
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:36:41.000Z',
  temperature: 31.60906219482422,
  humidity: 34.87907409667969,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 53,
  gyroscope_z: -135,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.7519784150135,
  gyroscope_total: 209.3680969011277,
  risk_level: 0,
  alarm_active: false,
  uptime: 1732,
  angle_x: 2.365389585494995,
  angle_y: -0.5957193970680237,
  angle_z: 2.43925183021583
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13367

⏱️  处理完成，耗时: 1514ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:37:11.512Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123711Z",
  "event_time_ms": "2025-07-18T12:37:11.360Z",
  "request_id": "8024fe17-c9d9-4323-bcfe-cce0fdc9705c",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 74.16666412353516,
            "humidity": 34.88822937011719,
            "acceleration_x": 5,
            "acceleration_y": 33,
            "acceleration_z": 864,
            "gyroscope_x": -151,
            "gyroscope_y": 50,
            "gyroscope_z": -133,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8654173612594604,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1763,
            "angle_x": 2.231135368347168,
            "angle_y": -0.3396942913532257,
            "angle_z": 2.256846747891319
          },
          "event_time": "20250718T123711Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 74.16666412353516,
  humidity: 34.88822937011719,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 864,
  gyroscope_x: -151,
  gyroscope_y: 50,
  gyroscope_z: -133,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8654173612594604,
  risk_level: 0,
  alarm_active: false,
  uptime: 1763,
  angle_x: 2.231135368347168,
  angle_y: -0.3396942913532257,
  angle_z: 2.256846747891319
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:37:11.000Z',
  temperature: 31.536964416503906,
  humidity: 34.88822937011719,
  illumination: 74.16666412353516,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 864,
  gyroscope_x: -151,
  gyroscope_y: 50,
  gyroscope_z: -133,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.6444355918795,
  gyroscope_total: 207.340299990137,
  risk_level: 0,
  alarm_active: false,
  uptime: 1763,
  angle_x: 2.231135368347168,
  angle_y: -0.3396942913532257,
  angle_z: 2.256846747891319
}
✅ 数据插入成功
插入的记录ID: 13368

⏱️  处理完成，耗时: 411ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:37:41.472Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123741Z",
  "event_time_ms": "2025-07-18T12:37:41.348Z",
  "request_id": "20a03997-f035-47cf-b1bd-4bfec3450e8e",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 34.87754821777344,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 867,
            "gyroscope_x": -154,
            "gyroscope_y": 44,
            "gyroscope_z": -128,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868105173110962,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1793,
            "angle_x": 2.1677849292755127,
            "angle_y": -0.6288899183273315,
            "angle_z": 2.257165042474253
          },
          "event_time": "20250718T123741Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 34.87754821777344,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 44,
  gyroscope_z: -128,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868105173110962,
  risk_level: 0,
  alarm_active: false,
  uptime: 1793,
  angle_x: 2.1677849292755127,
  angle_y: -0.6288899183273315,
  angle_z: 2.257165042474253
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:37:41.000Z',
  temperature: 31.579689025878906,
  humidity: 34.87754821777344,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 44,
  gyroscope_z: -128,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6370208791232,
  gyroscope_total: 205.02682751288916,
  risk_level: 0,
  alarm_active: false,
  uptime: 1793,
  angle_x: 2.1677849292755127,
  angle_y: -0.6288899183273315,
  angle_z: 2.257165042474253
}
✅ 数据插入成功
插入的记录ID: 13369

⏱️  处理完成，耗时: 472ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:38:11.652Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123811Z",
  "event_time_ms": "2025-07-18T12:38:11.487Z",
  "request_id": "0fe86710-3420-473f-a6cc-3937d1d79888",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 74.16666412353516,
            "humidity": 34.91569519042969,
            "acceleration_x": 7,
            "acceleration_y": 32,
            "acceleration_z": 866,
            "gyroscope_x": -152,
            "gyroscope_y": 48,
            "gyroscope_z": -131,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8672335743904114,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1822,
            "angle_x": 2.1780354976654053,
            "angle_y": -0.4761759638786316,
            "angle_z": 2.229480248323885
          },
          "event_time": "20250718T123811Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 74.16666412353516,
  humidity: 34.91569519042969,
  acceleration_x: 7,
  acceleration_y: 32,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8672335743904114,
  risk_level: 0,
  alarm_active: false,
  uptime: 1822,
  angle_x: 2.1780354976654053,
  angle_y: -0.4761759638786316,
  angle_z: 2.229480248323885
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:38:11.000Z',
  temperature: 31.550315856933594,
  humidity: 34.91569519042969,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 32,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6192935770586,
  gyroscope_total: 206.3225629929989,
  risk_level: 0,
  alarm_active: false,
  uptime: 1822,
  angle_x: 2.1780354976654053,
  angle_y: -0.4761759638786316,
  angle_z: 2.229480248323885
}
✅ 数据插入成功
插入的记录ID: 13370

⏱️  处理完成，耗时: 395ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 400
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:38:42.110Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123841Z",
  "event_time_ms": "2025-07-18T12:38:41.708Z",
  "request_id": "f3b98a61-c5f0-41cb-8ffd-eeb2cdc4f782",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.494239807128906,
            "illumination": 74.16666412353516,
            "humidity": 34.88365173339844,
            "acceleration_x": 8,
            "acceleration_y": 36,
            "acceleration_z": 866,
            "gyroscope_x": -148,
            "gyroscope_y": 44,
            "gyroscope_z": -131,
            "mpu_temperature": 31.494239807128906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867130994796753,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1853,
            "angle_x": 2.3962440490722656,
            "angle_y": -0.548963487148285,
            "angle_z": 2.4583218774066693
          },
          "event_time": "20250718T123841Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.494239807128906,
  illumination: 74.16666412353516,
  humidity: 34.88365173339844,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 866,
  gyroscope_x: -148,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867130994796753,
  risk_level: 0,
  alarm_active: false,
  uptime: 1853,
  angle_x: 2.3962440490722656,
  angle_y: -0.548963487148285,
  angle_z: 2.4583218774066693
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:38:41.000Z',
  temperature: 31.494239807128906,
  humidity: 34.88365173339844,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 866,
  gyroscope_x: -148,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7848637349408,
  gyroscope_total: 202.48703662210082,
  risk_level: 0,
  alarm_active: false,
  uptime: 1853,
  angle_x: 2.3962440490722656,
  angle_y: -0.548963487148285,
  angle_z: 2.4583218774066693
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13371

⏱️  处理完成，耗时: 2001ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备1 (77035712) (179801分钟)
📵 设备离线: 上坪监测设备2 (vice_006) (179163分钟)
📵 设备离线: 下湾监测设备1 (vice_007) (179158分钟)
📵 设备离线: 前岗监测设备1 (vice_008) (179153分钟)
📵 设备离线: 上坪监测设备3 (t_device) (69002分钟)
📵 设备离线: 龙门滑坡监测站 (10分钟)
🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:39:12.084Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123911Z",
  "event_time_ms": "2025-07-18T12:39:11.960Z",
  "request_id": "1d1519ca-75f7-44f1-b67b-a601da02c947",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.494239807128906,
            "illumination": 74.16666412353516,
            "humidity": 34.85618209838867,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 867,
            "gyroscope_x": -150,
            "gyroscope_y": 45,
            "gyroscope_z": -124,
            "mpu_temperature": 31.494239807128906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8686371445655823,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1883,
            "angle_x": 2.2550930976867676,
            "angle_y": -0.580190598964691,
            "angle_z": 2.3285330168072575
          },
          "event_time": "20250718T123911Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.494239807128906,
  illumination: 74.16666412353516,
  humidity: 34.85618209838867,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -150,
  gyroscope_y: 45,
  gyroscope_z: -124,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8686371445655823,
  risk_level: 0,
  alarm_active: false,
  uptime: 1883,
  angle_x: 2.2550930976867676,
  angle_y: -0.580190598964691,
  angle_z: 2.3285330168072575
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:39:11.000Z',
  temperature: 31.494239807128906,
  humidity: 34.85618209838867,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -150,
  gyroscope_y: 45,
  gyroscope_z: -124,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.7032903014716,
  gyroscope_total: 199.75234666956982,
  risk_level: 0,
  alarm_active: false,
  uptime: 1883,
  angle_x: 2.2550930976867676,
  angle_y: -0.580190598964691,
  angle_z: 2.3285330168072575
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13372

⏱️  处理完成，耗时: 630ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:39:42.180Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T123942Z",
  "event_time_ms": "2025-07-18T12:39:42.007Z",
  "request_id": "f58aa40b-de14-4eab-85bf-45feb6f0b659",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 74.16666412353516,
            "humidity": 34.71732711791992,
            "acceleration_x": 10,
            "acceleration_y": 34,
            "acceleration_z": 866,
            "gyroscope_x": -154,
            "gyroscope_y": 46,
            "gyroscope_z": -125,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8668362498283386,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1913,
            "angle_x": 2.275930404663086,
            "angle_y": -0.6944603323936462,
            "angle_z": 2.3795239776346384
          },
          "event_time": "20250718T123942Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 74.16666412353516,
  humidity: 34.71732711791992,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 46,
  gyroscope_z: -125,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8668362498283386,
  risk_level: 0,
  alarm_active: false,
  uptime: 1913,
  angle_x: 2.275930404663086,
  angle_y: -0.6944603323936462,
  angle_z: 2.3795239776346384
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:39:42.000Z',
  temperature: 31.507591247558594,
  humidity: 34.71732711791992,
  illumination: 74.16666412353516,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 46,
  gyroscope_z: -125,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7248698404817,
  gyroscope_total: 203.60992117281515,
  risk_level: 0,
  alarm_active: false,
  uptime: 1913,
  angle_x: 2.275930404663086,
  angle_y: -0.6944603323936462,
  angle_z: 2.3795239776346384
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13373

⏱️  处理完成，耗时: 640ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:40:12.413Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124012Z",
  "event_time_ms": "2025-07-18T12:40:12.257Z",
  "request_id": "779c1384-bec2-47c2-b8c2-cbf6df8fc1b9",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 74.16666412353516,
            "humidity": 35.05607604980469,
            "acceleration_x": 9,
            "acceleration_y": 35,
            "acceleration_z": 868,
            "gyroscope_x": -156,
            "gyroscope_y": 52,
            "gyroscope_z": -130,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8689175844192505,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1943,
            "angle_x": 2.3107542991638184,
            "angle_y": -0.5961381793022156,
            "angle_z": 2.38641282261176
          },
          "event_time": "20250718T124012Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 74.16666412353516,
  humidity: 35.05607604980469,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -156,
  gyroscope_y: 52,
  gyroscope_z: -130,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8689175844192505,
  risk_level: 0,
  alarm_active: false,
  uptime: 1943,
  angle_x: 2.3107542991638184,
  angle_y: -0.5961381793022156,
  angle_z: 2.38641282261176
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:40:12.000Z',
  temperature: 31.52094268798828,
  humidity: 35.05607604980469,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -156,
  gyroscope_y: 52,
  gyroscope_z: -130,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.7519784150135,
  gyroscope_total: 209.61870145576228,
  risk_level: 0,
  alarm_active: false,
  uptime: 1943,
  angle_x: 2.3107542991638184,
  angle_y: -0.5961381793022156,
  angle_z: 2.38641282261176
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13374

⏱️  处理完成，耗时: 609ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:40:42.480Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124042Z",
  "event_time_ms": "2025-07-18T12:40:42.325Z",
  "request_id": "b40c1235-a2ea-42e1-957b-8f24fc5a8604",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 75.8333282470703,
            "humidity": 35.04692077636719,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 865,
            "gyroscope_x": -150,
            "gyroscope_y": 48,
            "gyroscope_z": -131,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8665684461593628,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 1973,
            "angle_x": 2.268556594848633,
            "angle_y": -0.5815810561180115,
            "angle_z": 2.341919202036348
          },
          "event_time": "20250718T124042Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 75.8333282470703,
  humidity: 35.04692077636719,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -150,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8665684461593628,
  risk_level: 0,
  alarm_active: false,
  uptime: 1973,
  angle_x: 2.268556594848633,
  angle_y: -0.5815810561180115,
  angle_z: 2.341919202036348
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:40:42.000Z',
  temperature: 31.56633758544922,
  humidity: 35.04692077636719,
  illumination: 75.8333282470703,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -150,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.7049150836559,
  gyroscope_total: 204.8536062655476,
  risk_level: 0,
  alarm_active: false,
  uptime: 1973,
  angle_x: 2.268556594848633,
  angle_y: -0.5815810561180115,
  angle_z: 2.341919202036348
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13375

⏱️  处理完成，耗时: 627ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:41:12.643Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124112Z",
  "event_time_ms": "2025-07-18T12:41:12.467Z",
  "request_id": "235ca414-a570-47ae-87c9-93d4653f3e71",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 74.16666412353516,
            "humidity": 34.91111755371094,
            "acceleration_x": 10,
            "acceleration_y": 31,
            "acceleration_z": 866,
            "gyroscope_x": -152,
            "gyroscope_y": 47,
            "gyroscope_z": -127,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8668424487113953,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2003,
            "angle_x": 2.0740561485290527,
            "angle_y": -0.6943624019622803,
            "angle_z": 2.187200962991283
          },
          "event_time": "20250718T124112Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 74.16666412353516,
  humidity: 34.91111755371094,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 47,
  gyroscope_z: -127,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8668424487113953,
  risk_level: 0,
  alarm_active: false,
  uptime: 2003,
  angle_x: 2.0740561485290527,
  angle_y: -0.6943624019622803,
  angle_z: 2.187200962991283
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:41:12.000Z',
  temperature: 31.507591247558594,
  humidity: 34.91111755371094,
  illumination: 74.16666412353516,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 866,
  gyroscope_x: -152,
  gyroscope_y: 47,
  gyroscope_z: -127,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6123700940346,
  gyroscope_total: 203.57308270004657,
  risk_level: 0,
  alarm_active: false,
  uptime: 2003,
  angle_x: 2.0740561485290527,
  angle_y: -0.6943624019622803,
  angle_z: 2.187200962991283
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13376

⏱️  处理完成，耗时: 610ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 500
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:41:42.827Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124142Z",
  "event_time_ms": "2025-07-18T12:41:42.702Z",
  "request_id": "871a8081-6a8f-4894-816c-eaba1f481fd4",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.70817184448242,
            "acceleration_x": 8,
            "acceleration_y": 36,
            "acceleration_z": 865,
            "gyroscope_x": -160,
            "gyroscope_y": 48,
            "gyroscope_z": -128,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8666749596595764,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2034,
            "angle_x": 2.437891721725464,
            "angle_y": -0.58965802192688,
            "angle_z": 2.5081891136196783
          },
          "event_time": "20250718T124142Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.70817184448242,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 865,
  gyroscope_x: -160,
  gyroscope_y: 48,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8666749596595764,
  risk_level: 0,
  alarm_active: false,
  uptime: 2034,
  angle_x: 2.437891721725464,
  angle_y: -0.58965802192688,
  angle_z: 2.5081891136196783
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:41:42.000Z',
  temperature: 31.56633758544922,
  humidity: 34.70817184448242,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 865,
  gyroscope_x: -160,
  gyroscope_y: 48,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.785770268835,
  gyroscope_total: 210.44714300745449,
  risk_level: 0,
  alarm_active: false,
  uptime: 2034,
  angle_x: 2.437891721725464,
  angle_y: -0.58965802192688,
  angle_z: 2.5081891136196783
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13377

⏱️  处理完成，耗时: 1499ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:42:12.954Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124212Z",
  "event_time_ms": "2025-07-18T12:42:12.797Z",
  "request_id": "663e354b-063b-49f8-92eb-64e723f73eec",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.464866638183594,
            "illumination": 74.16666412353516,
            "humidity": 34.96452331542969,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 864,
            "gyroscope_x": -156,
            "gyroscope_y": 54,
            "gyroscope_z": -133,
            "mpu_temperature": 31.464866638183594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8652937412261963,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2063,
            "angle_x": 2.166743040084839,
            "angle_y": -0.622843623161316,
            "angle_z": 2.2544865447965763
          },
          "event_time": "20250718T124212Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.464866638183594,
  illumination: 74.16666412353516,
  humidity: 34.96452331542969,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -156,
  gyroscope_y: 54,
  gyroscope_z: -133,
  mpu_temperature: 31.464866638183594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8652937412261963,
  risk_level: 0,
  alarm_active: false,
  uptime: 2063,
  angle_x: 2.166743040084839,
  angle_y: -0.622843623161316,
  angle_z: 2.2544865447965763
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:42:12.000Z',
  temperature: 31.464866638183594,
  humidity: 34.96452331542969,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -156,
  gyroscope_y: 54,
  gyroscope_z: -133,
  mpu_temperature: 31.464866638183594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.6392311247507,
  gyroscope_total: 211.9929244102265,
  risk_level: 0,
  alarm_active: false,
  uptime: 2063,
  angle_x: 2.166743040084839,
  angle_y: -0.622843623161316,
  angle_z: 2.2544865447965763
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13378

⏱️  处理完成，耗时: 610ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:42:43.391Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124243Z",
  "event_time_ms": "2025-07-18T12:42:43.270Z",
  "request_id": "c72b0540-8ef1-4402-bd74-bfef27b174f1",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 75.8333282470703,
            "humidity": 34.98435974121094,
            "acceleration_x": 9,
            "acceleration_y": 31,
            "acceleration_z": 866,
            "gyroscope_x": -148,
            "gyroscope_y": 55,
            "gyroscope_z": -126,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8669657111167908,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2094,
            "angle_x": 2.1060519218444824,
            "angle_y": -0.597398042678833,
            "angle_z": 2.1891411829531093
          },
          "event_time": "20250718T124243Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 75.8333282470703,
  humidity: 34.98435974121094,
  acceleration_x: 9,
  acceleration_y: 31,
  acceleration_z: 866,
  gyroscope_x: -148,
  gyroscope_y: 55,
  gyroscope_z: -126,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8669657111167908,
  risk_level: 0,
  alarm_active: false,
  uptime: 2094,
  angle_x: 2.1060519218444824,
  angle_y: -0.597398042678833,
  angle_z: 2.1891411829531093
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:42:43.000Z',
  temperature: 31.52094268798828,
  humidity: 34.98435974121094,
  illumination: 75.8333282470703,
  acceleration_x: 9,
  acceleration_y: 31,
  acceleration_z: 866,
  gyroscope_x: -148,
  gyroscope_y: 55,
  gyroscope_z: -126,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6014077994565,
  gyroscope_total: 202.00247523235947,
  risk_level: 0,
  alarm_active: false,
  uptime: 2094,
  angle_x: 2.1060519218444824,
  angle_y: -0.597398042678833,
  angle_z: 2.1891411829531093
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13379

⏱️  处理完成，耗时: 598ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:43:13.460Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124313Z",
  "event_time_ms": "2025-07-18T12:43:13.333Z",
  "request_id": "86e24ae5-8422-41d3-bd3a-5a4616673595",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 76.66666412353516,
            "humidity": 35.04234313964844,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 856,
            "gyroscope_x": -173,
            "gyroscope_y": 43,
            "gyroscope_z": -130,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.857157588005066,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2124,
            "angle_x": 2.2608120441436768,
            "angle_y": -0.5879634022712708,
            "angle_z": 2.33601628019916
          },
          "event_time": "20250718T124313Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 76.66666412353516,
  humidity: 35.04234313964844,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 856,
  gyroscope_x: -173,
  gyroscope_y: 43,
  gyroscope_z: -130,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.857157588005066,
  risk_level: 0,
  alarm_active: false,
  uptime: 2124,
  angle_x: 2.2608120441436768,
  angle_y: -0.5879634022712708,
  angle_z: 2.33601628019916
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:43:13.000Z',
  temperature: 31.536964416503906,
  humidity: 35.04234313964844,
  illumination: 76.66666412353516,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 856,
  gyroscope_x: -173,
  gyroscope_y: 43,
  gyroscope_z: -130,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 856.6732165767761,
  gyroscope_total: 220.63091351848226,
  risk_level: 0,
  alarm_active: false,
  uptime: 2124,
  angle_x: 2.2608120441436768,
  angle_y: -0.5879634022712708,
  angle_z: 2.33601628019916
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13380

⏱️  处理完成，耗时: 1662ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:43:43.692Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124343Z",
  "event_time_ms": "2025-07-18T12:43:43.552Z",
  "request_id": "b12ad4dd-3a92-440e-b552-d123afffb494",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 80,
            "humidity": 34.68986129760742,
            "acceleration_x": 11,
            "acceleration_y": 35,
            "acceleration_z": 865,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -130,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8660342693328857,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2154,
            "angle_x": 2.3426995277404785,
            "angle_y": -0.759803533554077,
            "angle_z": 2.4628322084292957
          },
          "event_time": "20250718T124343Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 80,
  humidity: 34.68986129760742,
  acceleration_x: 11,
  acceleration_y: 35,
  acceleration_z: 865,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -130,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8660342693328857,
  risk_level: 0,
  alarm_active: false,
  uptime: 2154,
  angle_x: 2.3426995277404785,
  angle_y: -0.759803533554077,
  angle_z: 2.4628322084292957
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:43:43.000Z',
  temperature: 31.52094268798828,
  humidity: 34.68986129760742,
  illumination: 80,
  acceleration_x: 11,
  acceleration_y: 35,
  acceleration_z: 865,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -130,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.7776850901159,
  gyroscope_total: 206.49697334343668,
  risk_level: 0,
  alarm_active: false,
  uptime: 2154,
  angle_x: 2.3426995277404785,
  angle_y: -0.759803533554077,
  angle_z: 2.4628322084292957
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13381

⏱️  处理完成，耗时: 617ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备2 (77035712) (179806分钟)
📵 设备离线: 上坪监测设备4 (vice_006) (179168分钟)
📵 设备离线: 下湾监测设备2 (vice_007) (179163分钟)
📵 设备离线: 前岗监测设备2 (vice_008) (179158分钟)
📵 设备离线: 上坪监测设备5 (t_device) (69007分钟)
📵 设备离线: 龙门滑坡监测站 (15分钟)
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:44:13.895Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124413Z",
  "event_time_ms": "2025-07-18T12:44:13.778Z",
  "request_id": "51a15875-ffc3-4220-a1ea-8e3d9597f52a",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 80,
            "humidity": 34.70359420776367,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 863,
            "gyroscope_x": -162,
            "gyroscope_y": 48,
            "gyroscope_z": -129,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8640621900558472,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2184,
            "angle_x": 2.153632640838623,
            "angle_y": -0.6075246930122375,
            "angle_z": 2.237681792459588
          },
          "event_time": "20250718T124413Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 80,
  humidity: 34.70359420776367,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 863,
  gyroscope_x: -162,
  gyroscope_y: 48,
  gyroscope_z: -129,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8640621900558472,
  risk_level: 0,
  alarm_active: false,
  uptime: 2184,
  angle_x: 2.153632640838623,
  angle_y: -0.6075246930122375,
  angle_z: 2.237681792459588
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:44:13.000Z',
  temperature: 31.52094268798828,
  humidity: 34.70359420776367,
  illumination: 80,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 863,
  gyroscope_x: -162,
  gyroscope_y: 48,
  gyroscope_z: -129,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 863.639971284331,
  gyroscope_total: 212.5770448566825,
  risk_level: 0,
  alarm_active: false,
  uptime: 2184,
  angle_x: 2.153632640838623,
  angle_y: -0.6075246930122375,
  angle_z: 2.237681792459588
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13382

⏱️  处理完成，耗时: 2300ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 600
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:44:44.227Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124444Z",
  "event_time_ms": "2025-07-18T12:44:44.067Z",
  "request_id": "8f26e092-5c0f-4cbd-a77d-f4ab2dcd254d",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 77.5,
            "humidity": 34.83176803588867,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 871,
            "gyroscope_x": -148,
            "gyroscope_y": 51,
            "gyroscope_z": -128,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8724735379219055,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2214,
            "angle_x": 2.116816282272339,
            "angle_y": -0.6257201433181763,
            "angle_z": 2.207359705767822
          },
          "event_time": "20250718T124444Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 77.5,
  humidity: 34.83176803588867,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 871,
  gyroscope_x: -148,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8724735379219055,
  risk_level: 0,
  alarm_active: false,
  uptime: 2214,
  angle_x: 2.116816282272339,
  angle_y: -0.6257201433181763,
  angle_z: 2.207359705767822
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:44:44.000Z',
  temperature: 31.536964416503906,
  humidity: 34.83176803588867,
  illumination: 77.5,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 871,
  gyroscope_x: -148,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 871.6340975432295,
  gyroscope_total: 202.21028658305195,
  risk_level: 0,
  alarm_active: false,
  uptime: 2214,
  angle_x: 2.116816282272339,
  angle_y: -0.6257201433181763,
  angle_z: 2.207359705767822
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13383

⏱️  处理完成，耗时: 1514ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:45:14.268Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124514Z",
  "event_time_ms": "2025-07-18T12:45:14.105Z",
  "request_id": "4d83df92-be4f-4f43-be69-6a793e186c05",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 75.8333282470703,
            "humidity": 34.77378463745117,
            "acceleration_x": 7,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -154,
            "gyroscope_y": 46,
            "gyroscope_z": -128,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8675183057785034,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2244,
            "angle_x": 2.241866111755371,
            "angle_y": -0.500246226787567,
            "angle_z": 2.297000206889922
          },
          "event_time": "20250718T124514Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 75.8333282470703,
  humidity: 34.77378463745117,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 46,
  gyroscope_z: -128,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8675183057785034,
  risk_level: 0,
  alarm_active: false,
  uptime: 2244,
  angle_x: 2.241866111755371,
  angle_y: -0.500246226787567,
  angle_z: 2.297000206889922
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:45:14.000Z',
  temperature: 31.536964416503906,
  humidity: 34.77378463745117,
  illumination: 75.8333282470703,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 46,
  gyroscope_z: -128,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6567948155717,
  gyroscope_total: 205.46532554180524,
  risk_level: 0,
  alarm_active: false,
  uptime: 2244,
  angle_x: 2.241866111755371,
  angle_y: -0.500246226787567,
  angle_z: 2.297000206889922
}
✅ 数据插入成功
插入的记录ID: 13384

⏱️  处理完成，耗时: 420ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:45:44.485Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124544Z",
  "event_time_ms": "2025-07-18T12:45:44.305Z",
  "request_id": "0017d566-9780-4fe1-8abf-b840f3d530ff",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 34.87754821777344,
            "acceleration_x": 7,
            "acceleration_y": 35,
            "acceleration_z": 867,
            "gyroscope_x": -154,
            "gyroscope_y": 49,
            "gyroscope_z": -132,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.86817467212677,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2274,
            "angle_x": 2.32079529762268,
            "angle_y": -0.48376938700675964,
            "angle_z": 2.3706799938567085
          },
          "event_time": "20250718T124544Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 34.87754821777344,
  acceleration_x: 7,
  acceleration_y: 35,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 49,
  gyroscope_z: -132,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.86817467212677,
  risk_level: 0,
  alarm_active: false,
  uptime: 2274,
  angle_x: 2.32079529762268,
  angle_y: -0.48376938700675964,
  angle_z: 2.3706799938567085
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:45:44.000Z',
  temperature: 31.579689025878906,
  humidity: 34.87754821777344,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 35,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 49,
  gyroscope_z: -132,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.7344063709817,
  gyroscope_total: 208.6648029735729,
  risk_level: 0,
  alarm_active: false,
  uptime: 2274,
  angle_x: 2.32079529762268,
  angle_y: -0.48376938700675964,
  angle_z: 2.3706799938567085
}
✅ 数据插入成功
插入的记录ID: 13385

⏱️  处理完成，耗时: 402ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:46:14.554Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124614Z",
  "event_time_ms": "2025-07-18T12:46:14.415Z",
  "request_id": "bab5b88e-4ecf-45f4-814f-f7929bc2a7c4",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.72190475463867,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 863,
            "gyroscope_x": -150,
            "gyroscope_y": 54,
            "gyroscope_z": -122,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.863879144191742,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2305,
            "angle_x": 2.2756221294403076,
            "angle_y": -0.5428797006607056,
            "angle_z": 2.339481661690875
          },
          "event_time": "20250718T124614Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.72190475463867,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 863,
  gyroscope_x: -150,
  gyroscope_y: 54,
  gyroscope_z: -122,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.863879144191742,
  risk_level: 0,
  alarm_active: false,
  uptime: 2305,
  angle_x: 2.2756221294403076,
  angle_y: -0.5428797006607056,
  angle_z: 2.339481661690875
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:46:14.000Z',
  temperature: 31.56633758544922,
  humidity: 34.72190475463867,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 863,
  gyroscope_x: -150,
  gyroscope_y: 54,
  gyroscope_z: -122,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 863.7065473874793,
  gyroscope_total: 200.7485989988473,
  risk_level: 0,
  alarm_active: false,
  uptime: 2305,
  angle_x: 2.2756221294403076,
  angle_y: -0.5428797006607056,
  angle_z: 2.339481661690875
}
✅ 数据插入成功
插入的记录ID: 13386

⏱️  处理完成，耗时: 434ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:46:44.725Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124644Z",
  "event_time_ms": "2025-07-18T12:46:44.562Z",
  "request_id": "898c45de-a5fa-45af-bd39-b241e2a990c7",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 80,
            "humidity": 35.45433807373047,
            "acceleration_x": 6,
            "acceleration_y": 31,
            "acceleration_z": 867,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -122,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8682774901390076,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2334,
            "angle_x": 2.0948081016540527,
            "angle_y": -0.4030306339263916,
            "angle_z": 2.133226353352725
          },
          "event_time": "20250718T124644Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 80,
  humidity: 35.45433807373047,
  acceleration_x: 6,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -122,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8682774901390076,
  risk_level: 0,
  alarm_active: false,
  uptime: 2334,
  angle_x: 2.0948081016540527,
  angle_y: -0.4030306339263916,
  angle_z: 2.133226353352725
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:46:44.000Z',
  temperature: 31.579689025878906,
  humidity: 35.45433807373047,
  illumination: 80,
  acceleration_x: 6,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -122,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.5747806385338,
  gyroscope_total: 201.55644370746373,
  risk_level: 0,
  alarm_active: false,
  uptime: 2334,
  angle_x: 2.0948081016540527,
  angle_y: -0.4030306339263916,
  angle_z: 2.133226353352725
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13387

⏱️  处理完成，耗时: 617ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 700
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:47:14.822Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124714Z",
  "event_time_ms": "2025-07-18T12:47:14.663Z",
  "request_id": "f087c6fe-5c1b-4ad3-968b-fb9f545c5b4f",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 75,
            "humidity": 35.710689544677734,
            "acceleration_x": 10,
            "acceleration_y": 34,
            "acceleration_z": 869,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -128,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.870120942592621,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2364,
            "angle_x": 2.2432010173797607,
            "angle_y": -0.724002480506897,
            "angle_z": 2.3571445429064664
          },
          "event_time": "20250718T124714Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 75,
  humidity: 35.710689544677734,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.870120942592621,
  risk_level: 0,
  alarm_active: false,
  uptime: 2364,
  angle_x: 2.2432010173797607,
  angle_y: -0.724002480506897,
  angle_z: 2.3571445429064664
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:47:14.000Z',
  temperature: 31.579689025878906,
  humidity: 35.710689544677734,
  illumination: 75,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.7223694950015,
  gyroscope_total: 205.24375751773792,
  risk_level: 0,
  alarm_active: false,
  uptime: 2364,
  angle_x: 2.2432010173797607,
  angle_y: -0.724002480506897,
  angle_z: 2.3571445429064664
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13388

⏱️  处理完成，耗时: 1888ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:47:46.063Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124744Z",
  "event_time_ms": "2025-07-18T12:47:44.907Z",
  "request_id": "2d18c8a2-043f-45ea-b8a1-cb62be4fb9d5",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.60906219482422,
            "illumination": 74.16666412353516,
            "humidity": 34.5265884399414,
            "acceleration_x": 12,
            "acceleration_y": 32,
            "acceleration_z": 864,
            "gyroscope_x": -147,
            "gyroscope_y": 56,
            "gyroscope_z": -128,
            "mpu_temperature": 31.60906219482422,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.865565299987793,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2395,
            "angle_x": 2.149890899658203,
            "angle_y": -0.8167229294776917,
            "angle_z": 2.2997972136620612
          },
          "event_time": "20250718T124744Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.60906219482422,
  illumination: 74.16666412353516,
  humidity: 34.5265884399414,
  acceleration_x: 12,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -147,
  gyroscope_y: 56,
  gyroscope_z: -128,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.865565299987793,
  risk_level: 0,
  alarm_active: false,
  uptime: 2395,
  angle_x: 2.149890899658203,
  angle_y: -0.8167229294776917,
  angle_z: 2.2997972136620612
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:47:44.000Z',
  temperature: 31.60906219482422,
  humidity: 34.5265884399414,
  illumination: 74.16666412353516,
  acceleration_x: 12,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -147,
  gyroscope_y: 56,
  gyroscope_z: -128,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.6756617368156,
  gyroscope_total: 202.80285994038644,
  risk_level: 0,
  alarm_active: false,
  uptime: 2395,
  angle_x: 2.149890899658203,
  angle_y: -0.8167229294776917,
  angle_z: 2.2997972136620612
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13389

⏱️  处理完成，耗时: 877ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:48:15.158Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124815Z",
  "event_time_ms": "2025-07-18T12:48:15.022Z",
  "request_id": "1c4c651d-c8cf-4492-88d5-c3ce0642d206",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 73.3333282470703,
            "humidity": 34.604408264160156,
            "acceleration_x": 11,
            "acceleration_y": 33,
            "acceleration_z": 868,
            "gyroscope_x": -157,
            "gyroscope_y": 44,
            "gyroscope_z": -131,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.869142174720764,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2425,
            "angle_x": 2.221569061279297,
            "angle_y": -0.781184434890747,
            "angle_z": 2.354913632248315
          },
          "event_time": "20250718T124815Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 73.3333282470703,
  humidity: 34.604408264160156,
  acceleration_x: 11,
  acceleration_y: 33,
  acceleration_z: 868,
  gyroscope_x: -157,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.869142174720764,
  risk_level: 0,
  alarm_active: false,
  uptime: 2425,
  angle_x: 2.221569061279297,
  angle_y: -0.781184434890747,
  angle_z: 2.354913632248315
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:48:15.000Z',
  temperature: 31.550315856933594,
  humidity: 34.604408264160156,
  illumination: 73.3333282470703,
  acceleration_x: 11,
  acceleration_y: 33,
  acceleration_z: 868,
  gyroscope_x: -157,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.696724985193,
  gyroscope_total: 209.15544458607812,
  risk_level: 0,
  alarm_active: false,
  uptime: 2425,
  angle_x: 2.221569061279297,
  angle_y: -0.781184434890747,
  angle_z: 2.354913632248315
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13390

⏱️  处理完成，耗时: 418ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:48:45.169Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124845Z",
  "event_time_ms": "2025-07-18T12:48:45.013Z",
  "request_id": "b5c2e6c7-0caa-4b6c-925e-9ed15db024b3",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 73.3333282470703,
            "humidity": 34.5113296508789,
            "acceleration_x": 5,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -157,
            "gyroscope_y": 51,
            "gyroscope_z": -127,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867359459400177,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2455,
            "angle_x": 2.20192813873291,
            "angle_y": -0.3873458206653595,
            "angle_z": 2.2357379794892553
          },
          "event_time": "20250718T124845Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 73.3333282470703,
  humidity: 34.5113296508789,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -157,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867359459400177,
  risk_level: 0,
  alarm_active: false,
  uptime: 2455,
  angle_x: 2.20192813873291,
  angle_y: -0.3873458206653595,
  angle_z: 2.2357379794892553
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:48:45.000Z',
  temperature: 31.579689025878906,
  humidity: 34.5113296508789,
  illumination: 73.3333282470703,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -157,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6429483933969,
  gyroscope_total: 208.27625884867436,
  risk_level: 0,
  alarm_active: false,
  uptime: 2455,
  angle_x: 2.20192813873291,
  angle_y: -0.3873458206653595,
  angle_z: 2.2357379794892553
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13391

⏱️  处理完成，耗时: 441ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备3 (77035712) (179811分钟)
📵 设备离线: 上坪监测设备6 (vice_006) (179173分钟)
📵 设备离线: 下湾监测设备3 (vice_007) (179168分钟)
📵 设备离线: 前岗监测设备3 (vice_008) (179163分钟)
📵 设备离线: 上坪监测设备7 (t_device) (69012分钟)
📵 设备离线: 龙门滑坡监测站 (20分钟)
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:49:15.205Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124915Z",
  "event_time_ms": "2025-07-18T12:49:15.072Z",
  "request_id": "21ec616b-642e-44a4-a144-5f05336a355b",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.59571075439453,
            "illumination": 74.16666412353516,
            "humidity": 34.540321350097656,
            "acceleration_x": 8,
            "acceleration_y": 30,
            "acceleration_z": 868,
            "gyroscope_x": -156,
            "gyroscope_y": 41,
            "gyroscope_z": -128,
            "mpu_temperature": 31.59571075439453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8687496781349182,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2485,
            "angle_x": 2.0292210578918457,
            "angle_y": -0.5558611750602722,
            "angle_z": 2.1039771262376137
          },
          "event_time": "20250718T124915Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.59571075439453,
  illumination: 74.16666412353516,
  humidity: 34.540321350097656,
  acceleration_x: 8,
  acceleration_y: 30,
  acceleration_z: 868,
  gyroscope_x: -156,
  gyroscope_y: 41,
  gyroscope_z: -128,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8687496781349182,
  risk_level: 0,
  alarm_active: false,
  uptime: 2485,
  angle_x: 2.0292210578918457,
  angle_y: -0.5558611750602722,
  angle_z: 2.1039771262376137
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:49:15.000Z',
  temperature: 31.59571075439453,
  humidity: 34.540321350097656,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 30,
  acceleration_z: 868,
  gyroscope_x: -156,
  gyroscope_y: 41,
  gyroscope_z: -128,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.5551220273818,
  gyroscope_total: 205.91503102007877,
  risk_level: 0,
  alarm_active: false,
  uptime: 2485,
  angle_x: 2.0292210578918457,
  angle_y: -0.5558611750602722,
  angle_z: 2.1039771262376137
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13392

⏱️  处理完成，耗时: 650ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:49:45.737Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T124945Z",
  "event_time_ms": "2025-07-18T12:49:45.568Z",
  "request_id": "9959a847-3fb7-41b1-a7da-87eb38e4f30c",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 73.3333282470703,
            "humidity": 34.5662612915039,
            "acceleration_x": 10,
            "acceleration_y": 34,
            "acceleration_z": 865,
            "gyroscope_x": -151,
            "gyroscope_y": 50,
            "gyroscope_z": -137,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8667080402374268,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2515,
            "angle_x": 2.268190860748291,
            "angle_y": -0.6864826679229736,
            "angle_z": 2.3697991970082017
          },
          "event_time": "20250718T124945Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 73.3333282470703,
  humidity: 34.5662612915039,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -151,
  gyroscope_y: 50,
  gyroscope_z: -137,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8667080402374268,
  risk_level: 0,
  alarm_active: false,
  uptime: 2515,
  angle_x: 2.268190860748291,
  angle_y: -0.6864826679229736,
  angle_z: 2.3697991970082017
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:49:45.000Z',
  temperature: 31.550315856933594,
  humidity: 34.5662612915039,
  illumination: 73.3333282470703,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -151,
  gyroscope_y: 50,
  gyroscope_z: -137,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.7257071382367,
  gyroscope_total: 209.92855927672156,
  risk_level: 0,
  alarm_active: false,
  uptime: 2515,
  angle_x: 2.268190860748291,
  angle_y: -0.6864826679229736,
  angle_z: 2.3697991970082017
}
✅ 数据插入成功
插入的记录ID: 13393

⏱️  处理完成，耗时: 425ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 800
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:50:15.827Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125015Z",
  "event_time_ms": "2025-07-18T12:50:15.715Z",
  "request_id": "f967065e-fcb1-4008-b823-83ae33feb9a7",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.576942443847656,
            "acceleration_x": 13,
            "acceleration_y": 34,
            "acceleration_z": 866,
            "gyroscope_x": -154,
            "gyroscope_y": 48,
            "gyroscope_z": -126,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8671215176582336,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2545,
            "angle_x": 2.267108917236328,
            "angle_y": -0.9121990203857422,
            "angle_z": 2.4437450553208664
          },
          "event_time": "20250718T125015Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.576942443847656,
  acceleration_x: 13,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 48,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8671215176582336,
  risk_level: 0,
  alarm_active: false,
  uptime: 2545,
  angle_x: 2.267108917236328,
  angle_y: -0.9121990203857422,
  angle_z: 2.4437450553208664
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:50:15.000Z',
  temperature: 31.56633758544922,
  humidity: 34.576942443847656,
  illumination: 74.16666412353516,
  acceleration_x: 13,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 48,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7646739455871,
  gyroscope_total: 204.68512403201166,
  risk_level: 0,
  alarm_active: false,
  uptime: 2545,
  angle_x: 2.267108917236328,
  angle_y: -0.9121990203857422,
  angle_z: 2.4437450553208664
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13394

⏱️  处理完成，耗时: 996ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:50:45.955Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125045Z",
  "event_time_ms": "2025-07-18T12:50:45.827Z",
  "request_id": "9f37916e-b7c2-4032-861f-7e87f4859046",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.5082778930664,
            "acceleration_x": 6,
            "acceleration_y": 32,
            "acceleration_z": 869,
            "gyroscope_x": -156,
            "gyroscope_y": 49,
            "gyroscope_z": -128,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.869665563106537,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2575,
            "angle_x": 2.163893699645996,
            "angle_y": -0.4506950080394745,
            "angle_z": 2.21033072946999
          },
          "event_time": "20250718T125045Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.5082778930664,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 869,
  gyroscope_x: -156,
  gyroscope_y: 49,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.869665563106537,
  risk_level: 0,
  alarm_active: false,
  uptime: 2575,
  angle_x: 2.163893699645996,
  angle_y: -0.4506950080394745,
  angle_z: 2.21033072946999
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:50:45.000Z',
  temperature: 31.56633758544922,
  humidity: 34.5082778930664,
  illumination: 74.16666412353516,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 869,
  gyroscope_x: -156,
  gyroscope_y: 49,
  gyroscope_z: -128,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.6096825587903,
  gyroscope_total: 207.65596548137017,
  risk_level: 0,
  alarm_active: false,
  uptime: 2575,
  angle_x: 2.163893699645996,
  angle_y: -0.4506950080394745,
  angle_z: 2.21033072946999
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13395

⏱️  处理完成，耗时: 1448ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:51:16.057Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125115Z",
  "event_time_ms": "2025-07-18T12:51:15.932Z",
  "request_id": "b83bcf20-e8ab-4ce8-9d11-a4737449df7d",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 34.607460021972656,
            "acceleration_x": 7,
            "acceleration_y": 30,
            "acceleration_z": 865,
            "gyroscope_x": -153,
            "gyroscope_y": 57,
            "gyroscope_z": -129,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8659285306930542,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2605,
            "angle_x": 2.0196709632873535,
            "angle_y": -0.509174644947052,
            "angle_z": 2.0828657227490743
          },
          "event_time": "20250718T125115Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 34.607460021972656,
  acceleration_x: 7,
  acceleration_y: 30,
  acceleration_z: 865,
  gyroscope_x: -153,
  gyroscope_y: 57,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8659285306930542,
  risk_level: 0,
  alarm_active: false,
  uptime: 2605,
  angle_x: 2.0196709632873535,
  angle_y: -0.509174644947052,
  angle_z: 2.0828657227490743
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:51:15.000Z',
  temperature: 31.579689025878906,
  humidity: 34.607460021972656,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 30,
  acceleration_z: 865,
  gyroscope_x: -153,
  gyroscope_y: 57,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.548381085656,
  gyroscope_total: 208.08411760631805,
  risk_level: 0,
  alarm_active: false,
  uptime: 2605,
  angle_x: 2.0196709632873535,
  angle_y: -0.509174644947052,
  angle_z: 2.0828657227490743
}
✅ 数据插入成功
插入的记录ID: 13396

⏱️  处理完成，耗时: 439ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:51:46.617Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125146Z",
  "event_time_ms": "2025-07-18T12:51:46.487Z",
  "request_id": "120a3ccc-740c-45e3-b548-121f3a5ba9dd",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.424354553222656,
            "acceleration_x": 5,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -155,
            "gyroscope_y": 53,
            "gyroscope_z": -126,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8671070337295532,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2636,
            "angle_x": 2.1864256858825684,
            "angle_y": -0.3955267369747162,
            "angle_z": 2.22191329253617
          },
          "event_time": "20250718T125146Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.424354553222656,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -155,
  gyroscope_y: 53,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8671070337295532,
  risk_level: 0,
  alarm_active: false,
  uptime: 2636,
  angle_x: 2.1864256858825684,
  angle_y: -0.3955267369747162,
  angle_z: 2.22191329253617
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:51:46.000Z',
  temperature: 31.56633758544922,
  humidity: 34.424354553222656,
  illumination: 74.16666412353516,
  acceleration_x: 5,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -155,
  gyroscope_y: 53,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6429483933969,
  gyroscope_total: 206.66397847714052,
  risk_level: 0,
  alarm_active: false,
  uptime: 2636,
  angle_x: 2.1864256858825684,
  angle_y: -0.3955267369747162,
  angle_z: 2.22191329253617
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13397

⏱️  处理完成，耗时: 454ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:52:16.607Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125216Z",
  "event_time_ms": "2025-07-18T12:52:16.459Z",
  "request_id": "615deae0-42b1-4599-95aa-e872bbe3e20f",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.60906219482422,
            "illumination": 74.16666412353516,
            "humidity": 34.5265884399414,
            "acceleration_x": 10,
            "acceleration_y": 32,
            "acceleration_z": 870,
            "gyroscope_x": -149,
            "gyroscope_y": 55,
            "gyroscope_z": -131,
            "mpu_temperature": 31.60906219482422,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8708001375198364,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2665,
            "angle_x": 2.1691107749938965,
            "angle_y": -0.667134463787079,
            "angle_z": 2.2693853676639177
          },
          "event_time": "20250718T125216Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.60906219482422,
  illumination: 74.16666412353516,
  humidity: 34.5265884399414,
  acceleration_x: 10,
  acceleration_y: 32,
  acceleration_z: 870,
  gyroscope_x: -149,
  gyroscope_y: 55,
  gyroscope_z: -131,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8708001375198364,
  risk_level: 0,
  alarm_active: false,
  uptime: 2665,
  angle_x: 2.1691107749938965,
  angle_y: -0.667134463787079,
  angle_z: 2.2693853676639177
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:52:16.000Z',
  temperature: 31.60906219482422,
  humidity: 34.5265884399414,
  illumination: 74.16666412353516,
  acceleration_x: 10,
  acceleration_y: 32,
  acceleration_z: 870,
  gyroscope_x: -149,
  gyroscope_y: 55,
  gyroscope_z: -131,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 870.6457373696836,
  gyroscope_total: 205.88103360921812,
  risk_level: 0,
  alarm_active: false,
  uptime: 2665,
  angle_x: 2.1691107749938965,
  angle_y: -0.667134463787079,
  angle_z: 2.2693853676639177
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13398

⏱️  处理完成，耗时: 627ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:52:46.683Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125246Z",
  "event_time_ms": "2025-07-18T12:52:46.557Z",
  "request_id": "11934755-592d-4559-8e10-90ca1455d229",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 73.3333282470703,
            "humidity": 34.32516860961914,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 862,
            "gyroscope_x": -146,
            "gyroscope_y": 41,
            "gyroscope_z": -129,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8636375665664673,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2696,
            "angle_x": 2.276259422302246,
            "angle_y": -0.5592422485351562,
            "angle_z": 2.343951546036396
          },
          "event_time": "20250718T125246Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 73.3333282470703,
  humidity: 34.32516860961914,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 862,
  gyroscope_x: -146,
  gyroscope_y: 41,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8636375665664673,
  risk_level: 0,
  alarm_active: false,
  uptime: 2696,
  angle_x: 2.276259422302246,
  angle_y: -0.5592422485351562,
  angle_z: 2.343951546036396
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:52:46.000Z',
  temperature: 31.579689025878906,
  humidity: 34.32516860961914,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 862,
  gyroscope_x: -146,
  gyroscope_y: 41,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 862.7073663763397,
  gyroscope_total: 199.09294311953903,
  risk_level: 0,
  alarm_active: false,
  uptime: 2696,
  angle_x: 2.276259422302246,
  angle_y: -0.5592422485351562,
  angle_z: 2.343951546036396
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13399

⏱️  处理完成，耗时: 653ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 900
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:53:16.860Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125316Z",
  "event_time_ms": "2025-07-18T12:53:16.696Z",
  "request_id": "c9bad9f6-39aa-4950-b162-dc9427244ff0",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.59571075439453,
            "illumination": 74.16666412353516,
            "humidity": 34.415199279785156,
            "acceleration_x": 10,
            "acceleration_y": 31,
            "acceleration_z": 869,
            "gyroscope_x": -152,
            "gyroscope_y": 45,
            "gyroscope_z": -128,
            "mpu_temperature": 31.59571075439453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8696378469467163,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2726,
            "angle_x": 2.059338331222534,
            "angle_y": -0.6599305868148804,
            "angle_z": 2.1624945645842084
          },
          "event_time": "20250718T125316Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.59571075439453,
  illumination: 74.16666412353516,
  humidity: 34.415199279785156,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 869,
  gyroscope_x: -152,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8696378469467163,
  risk_level: 0,
  alarm_active: false,
  uptime: 2726,
  angle_x: 2.059338331222534,
  angle_y: -0.6599305868148804,
  angle_z: 2.1624945645842084
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:53:16.000Z',
  temperature: 31.59571075439453,
  humidity: 34.415199279785156,
  illumination: 74.16666412353516,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 869,
  gyroscope_x: -152,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.6102575291991,
  gyroscope_total: 203.74739262135355,
  risk_level: 0,
  alarm_active: false,
  uptime: 2726,
  angle_x: 2.059338331222534,
  angle_y: -0.6599305868148804,
  angle_z: 2.1624945645842084
}
✅ 数据插入成功
插入的记录ID: 13400

⏱️  处理完成，耗时: 737ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:53:46.796Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125346Z",
  "event_time_ms": "2025-07-18T12:53:46.682Z",
  "request_id": "78c6ef98-d643-4b20-b251-4c70a3a715f7",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 34.35568618774414,
            "acceleration_x": 9,
            "acceleration_y": 30,
            "acceleration_z": 867,
            "gyroscope_x": -153,
            "gyroscope_y": 49,
            "gyroscope_z": -129,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8681458830833435,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2756,
            "angle_x": 2.030632972717285,
            "angle_y": -0.5965574979782104,
            "angle_z": 2.1164477594026887
          },
          "event_time": "20250718T125346Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 34.35568618774414,
  acceleration_x: 9,
  acceleration_y: 30,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 49,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8681458830833435,
  risk_level: 0,
  alarm_active: false,
  uptime: 2756,
  angle_x: 2.030632972717285,
  angle_y: -0.5965574979782104,
  angle_z: 2.1164477594026887
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:53:46.000Z',
  temperature: 31.579689025878906,
  humidity: 34.35568618774414,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 30,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 49,
  gyroscope_z: -129,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.5655594823944,
  gyroscope_total: 206.03640455026388,
  risk_level: 0,
  alarm_active: false,
  uptime: 2756,
  angle_x: 2.030632972717285,
  angle_y: -0.5965574979782104,
  angle_z: 2.1164477594026887
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13401

⏱️  处理完成，耗时: 4033ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备4 (77035712) (179816分钟)
📵 设备离线: 上坪监测设备8 (vice_006) (179178分钟)
📵 设备离线: 下湾监测设备4 (vice_007) (179173分钟)
📵 设备离线: 前岗监测设备4 (vice_008) (179168分钟)
📵 设备离线: 上坪监测设备9 (t_device) (69017分钟)
📵 设备离线: 龙门滑坡监测站 (25分钟)
🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:54:17.053Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125416Z",
  "event_time_ms": "2025-07-18T12:54:16.948Z",
  "request_id": "7c2e9ef4-02b8-4900-a684-77c0c8f3a380",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.59571075439453,
            "illumination": 74.16666412353516,
            "humidity": 34.497596740722656,
            "acceleration_x": 8,
            "acceleration_y": 36,
            "acceleration_z": 883,
            "gyroscope_x": -150,
            "gyroscope_y": 52,
            "gyroscope_z": -136,
            "mpu_temperature": 31.59571075439453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.884316325187683,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2786,
            "angle_x": 2.3338189125061035,
            "angle_y": -0.5303547382354736,
            "angle_z": 2.3933213041169354
          },
          "event_time": "20250718T125416Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.59571075439453,
  illumination: 74.16666412353516,
  humidity: 34.497596740722656,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 883,
  gyroscope_x: -150,
  gyroscope_y: 52,
  gyroscope_z: -136,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.884316325187683,
  risk_level: 0,
  alarm_active: false,
  uptime: 2786,
  angle_x: 2.3338189125061035,
  angle_y: -0.5303547382354736,
  angle_z: 2.3933213041169354
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:54:16.000Z',
  temperature: 31.59571075439453,
  humidity: 34.497596740722656,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 883,
  gyroscope_x: -150,
  gyroscope_y: 52,
  gyroscope_z: -136,
  mpu_temperature: 31.59571075439453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 883.7697663984665,
  gyroscope_total: 209.04544960366871,
  risk_level: 0,
  alarm_active: false,
  uptime: 2786,
  angle_x: 2.3338189125061035,
  angle_y: -0.5303547382354736,
  angle_z: 2.3933213041169354
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13402

⏱️  处理完成，耗时: 634ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:54:47.371Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125447Z",
  "event_time_ms": "2025-07-18T12:54:47.205Z",
  "request_id": "c44fcb51-8caa-4764-91e8-cd716b6b35d5",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 35.8907470703125,
            "acceleration_x": 9,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -159,
            "gyroscope_y": 43,
            "gyroscope_z": -131,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867137312889099,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2816,
            "angle_x": 2.1863491535186768,
            "angle_y": -0.6215274930000305,
            "angle_z": 2.27297581281604
          },
          "event_time": "20250718T125447Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 35.8907470703125,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -159,
  gyroscope_y: 43,
  gyroscope_z: -131,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867137312889099,
  risk_level: 0,
  alarm_active: false,
  uptime: 2816,
  angle_x: 2.1863491535186768,
  angle_y: -0.6215274930000305,
  angle_z: 2.27297581281604
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:54:47.000Z',
  temperature: 31.579689025878906,
  humidity: 35.8907470703125,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -159,
  gyroscope_y: 43,
  gyroscope_z: -131,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6752563676894,
  gyroscope_total: 210.45427056726598,
  risk_level: 0,
  alarm_active: false,
  uptime: 2816,
  angle_x: 2.1863491535186768,
  angle_y: -0.6215274930000305,
  angle_z: 2.27297581281604
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13403

⏱️  处理完成，耗时: 650ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:55:17.480Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125517Z",
  "event_time_ms": "2025-07-18T12:55:17.335Z",
  "request_id": "4bf7fc83-2648-4e4c-b10c-cd4e6a308621",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 74.16666412353516,
            "humidity": 34.522010803222656,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 863,
            "gyroscope_x": -157,
            "gyroscope_y": 45,
            "gyroscope_z": -125,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8644638061523438,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2846,
            "angle_x": 2.2255008220672607,
            "angle_y": -0.5667855143547058,
            "angle_z": 2.296540817905134
          },
          "event_time": "20250718T125517Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 74.16666412353516,
  humidity: 34.522010803222656,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 863,
  gyroscope_x: -157,
  gyroscope_y: 45,
  gyroscope_z: -125,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8644638061523438,
  risk_level: 0,
  alarm_active: false,
  uptime: 2846,
  angle_x: 2.2255008220672607,
  angle_y: -0.5667855143547058,
  angle_z: 2.296540817905134
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:55:17.000Z',
  temperature: 31.550315856933594,
  humidity: 34.522010803222656,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 863,
  gyroscope_x: -157,
  gyroscope_y: 45,
  gyroscope_z: -125,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 863.6677601948564,
  gyroscope_total: 205.66720691447142,
  risk_level: 0,
  alarm_active: false,
  uptime: 2846,
  angle_x: 2.2255008220672607,
  angle_y: -0.5667855143547058,
  angle_z: 2.296540817905134
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13404

⏱️  处理完成，耗时: 680ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:55:47.724Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125547Z",
  "event_time_ms": "2025-07-18T12:55:47.570Z",
  "request_id": "86475e77-312f-4bcb-ad67-c677c9dbc608",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 74.16666412353516,
            "humidity": 34.3236427307129,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 867,
            "gyroscope_x": -146,
            "gyroscope_y": 55,
            "gyroscope_z": -130,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8678370118141174,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2876,
            "angle_x": 2.1281306743621826,
            "angle_y": -0.6210025548934937,
            "angle_z": 2.2168861811887153
          },
          "event_time": "20250718T125547Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 74.16666412353516,
  humidity: 34.3236427307129,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -146,
  gyroscope_y: 55,
  gyroscope_z: -130,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8678370118141174,
  risk_level: 0,
  alarm_active: false,
  uptime: 2876,
  angle_x: 2.1281306743621826,
  angle_y: -0.6210025548934937,
  angle_z: 2.2168861811887153
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:55:47.000Z',
  temperature: 31.550315856933594,
  humidity: 34.3236427307129,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 867,
  gyroscope_x: -146,
  gyroscope_y: 55,
  gyroscope_z: -130,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6370208791232,
  gyroscope_total: 203.07880243885623,
  risk_level: 0,
  alarm_active: false,
  uptime: 2876,
  angle_x: 2.1281306743621826,
  angle_y: -0.6210025548934937,
  angle_z: 2.2168861811887153
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13405

⏱️  处理完成，耗时: 647ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:56:17.929Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125617Z",
  "event_time_ms": "2025-07-18T12:56:17.827Z",
  "request_id": "a7d45a35-670a-4dc0-b7a3-e058805beb00",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.3694190979004,
            "acceleration_x": 9,
            "acceleration_y": 31,
            "acceleration_z": 867,
            "gyroscope_x": -150,
            "gyroscope_y": 45,
            "gyroscope_z": -123,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8681804537773132,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2906,
            "angle_x": 2.0869810581207275,
            "angle_y": -0.6207404732704163,
            "angle_z": 2.1773398154883155
          },
          "event_time": "20250718T125617Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.3694190979004,
  acceleration_x: 9,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -150,
  gyroscope_y: 45,
  gyroscope_z: -123,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8681804537773132,
  risk_level: 0,
  alarm_active: false,
  uptime: 2906,
  angle_x: 2.0869810581207275,
  angle_y: -0.6207404732704163,
  angle_z: 2.1773398154883155
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:56:17.000Z',
  temperature: 31.56633758544922,
  humidity: 34.3694190979004,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 31,
  acceleration_z: 867,
  gyroscope_x: -150,
  gyroscope_y: 45,
  gyroscope_z: -123,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6007146147357,
  gyroscope_total: 199.1331213033131,
  risk_level: 0,
  alarm_active: false,
  uptime: 2906,
  angle_x: 2.0869810581207275,
  angle_y: -0.6207404732704163,
  angle_z: 2.1773398154883155
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13406

⏱️  处理完成，耗时: 636ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 1000
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:56:48.071Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125647Z",
  "event_time_ms": "2025-07-18T12:56:47.901Z",
  "request_id": "89cbd64c-ce99-45fa-91dd-1e4a77f269cf",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.550315856933594,
            "illumination": 73.3333282470703,
            "humidity": 34.396888732910156,
            "acceleration_x": 9,
            "acceleration_y": 34,
            "acceleration_z": 864,
            "gyroscope_x": -153,
            "gyroscope_y": 47,
            "gyroscope_z": -124,
            "mpu_temperature": 31.550315856933594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.865599751472473,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2937,
            "angle_x": 2.263010263442993,
            "angle_y": -0.6550114154815674,
            "angle_z": 2.3558980043413364
          },
          "event_time": "20250718T125647Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.550315856933594,
  illumination: 73.3333282470703,
  humidity: 34.396888732910156,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 864,
  gyroscope_x: -153,
  gyroscope_y: 47,
  gyroscope_z: -124,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.865599751472473,
  risk_level: 0,
  alarm_active: false,
  uptime: 2937,
  angle_x: 2.263010263442993,
  angle_y: -0.6550114154815674,
  angle_z: 2.3558980043413364
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:56:47.000Z',
  temperature: 31.550315856933594,
  humidity: 34.396888732910156,
  illumination: 73.3333282470703,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 864,
  gyroscope_x: -153,
  gyroscope_y: 47,
  gyroscope_z: -124,
  mpu_temperature: 31.550315856933594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.7155601699324,
  gyroscope_total: 202.46975082712973,
  risk_level: 0,
  alarm_active: false,
  uptime: 2937,
  angle_x: 2.263010263442993,
  angle_y: -0.6550114154815674,
  angle_z: 2.3558980043413364
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13407

⏱️  处理完成，耗时: 1464ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:57:18.427Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125718Z",
  "event_time_ms": "2025-07-18T12:57:18.287Z",
  "request_id": "fdcea244-9351-499d-846d-48571edcdec9",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 74.16666412353516,
            "humidity": 34.4380874633789,
            "acceleration_x": 9,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -154,
            "gyroscope_y": 51,
            "gyroscope_z": -126,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8670287132263184,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2967,
            "angle_x": 2.202768564224243,
            "angle_y": -0.645831823348999,
            "angle_z": 2.2954929953247136
          },
          "event_time": "20250718T125718Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 74.16666412353516,
  humidity: 34.4380874633789,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 51,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8670287132263184,
  risk_level: 0,
  alarm_active: false,
  uptime: 2967,
  angle_x: 2.202768564224243,
  angle_y: -0.645831823348999,
  angle_z: 2.2954929953247136
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:57:18.000Z',
  temperature: 31.56633758544922,
  humidity: 34.4380874633789,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 51,
  gyroscope_z: -126,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6752563676894,
  gyroscope_total: 205.4093474017188,
  risk_level: 0,
  alarm_active: false,
  uptime: 2967,
  angle_x: 2.202768564224243,
  angle_y: -0.645831823348999,
  angle_z: 2.2954929953247136
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13408

⏱️  处理完成，耗时: 627ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:57:48.691Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125748Z",
  "event_time_ms": "2025-07-18T12:57:48.528Z",
  "request_id": "c3a45478-0b17-400a-898e-31ac0ccaffab",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.494239807128906,
            "illumination": 73.3333282470703,
            "humidity": 34.2046241760254,
            "acceleration_x": 5,
            "acceleration_y": 35,
            "acceleration_z": 864,
            "gyroscope_x": -150,
            "gyroscope_y": 51,
            "gyroscope_z": -128,
            "mpu_temperature": 31.494239807128906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8652347326278687,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 2997,
            "angle_x": 2.3286852836608887,
            "angle_y": -0.37215036153793335,
            "angle_z": 2.3582347300325317
          },
          "event_time": "20250718T125748Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.494239807128906,
  illumination: 73.3333282470703,
  humidity: 34.2046241760254,
  acceleration_x: 5,
  acceleration_y: 35,
  acceleration_z: 864,
  gyroscope_x: -150,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8652347326278687,
  risk_level: 0,
  alarm_active: false,
  uptime: 2997,
  angle_x: 2.3286852836608887,
  angle_y: -0.37215036153793335,
  angle_z: 2.3582347300325317
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:57:48.000Z',
  temperature: 31.494239807128906,
  humidity: 34.2046241760254,
  illumination: 73.3333282470703,
  acceleration_x: 5,
  acceleration_y: 35,
  acceleration_z: 864,
  gyroscope_x: -150,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.494239807128906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.7230770599336,
  gyroscope_total: 203.67866849525504,
  risk_level: 0,
  alarm_active: false,
  uptime: 2997,
  angle_x: 2.3286852836608887,
  angle_y: -0.37215036153793335,
  angle_z: 2.3582347300325317
}
✅ 数据插入成功
插入的记录ID: 13409

⏱️  处理完成，耗时: 467ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:58:18.800Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125818Z",
  "event_time_ms": "2025-07-18T12:58:18.625Z",
  "request_id": "f25636f1-24e8-42cf-b391-0dd3203b3f62",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 73.3333282470703,
            "humidity": 34.5723648071289,
            "acceleration_x": 9,
            "acceleration_y": 29,
            "acceleration_z": 867,
            "gyroscope_x": -157,
            "gyroscope_y": 45,
            "gyroscope_z": -135,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867745578289032,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3027,
            "angle_x": 1.9589853286743164,
            "angle_y": -0.6210025548934937,
            "angle_z": 2.0550590480921627
          },
          "event_time": "20250718T125818Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 73.3333282470703,
  humidity: 34.5723648071289,
  acceleration_x: 9,
  acceleration_y: 29,
  acceleration_z: 867,
  gyroscope_x: -157,
  gyroscope_y: 45,
  gyroscope_z: -135,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867745578289032,
  risk_level: 0,
  alarm_active: false,
  uptime: 3027,
  angle_x: 1.9589853286743164,
  angle_y: -0.6210025548934937,
  angle_z: 2.0550590480921627
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:58:18.000Z',
  temperature: 31.507591247558594,
  humidity: 34.5723648071289,
  illumination: 73.3333282470703,
  acceleration_x: 9,
  acceleration_y: 29,
  acceleration_z: 867,
  gyroscope_x: -157,
  gyroscope_y: 45,
  gyroscope_z: -135,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.5315556220419,
  gyroscope_total: 211.8938413451415,
  risk_level: 0,
  alarm_active: false,
  uptime: 3027,
  angle_x: 1.9589853286743164,
  angle_y: -0.6210025548934937,
  angle_z: 2.0550590480921627
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13410

⏱️  处理完成，耗时: 550ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:58:48.866Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125848Z",
  "event_time_ms": "2025-07-18T12:58:48.737Z",
  "request_id": "8b53d9ea-577f-422b-83af-e5a8de95ee35",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 74.16666412353516,
            "humidity": 34.4899673461914,
            "acceleration_x": 10,
            "acceleration_y": 31,
            "acceleration_z": 863,
            "gyroscope_x": -158,
            "gyroscope_y": 52,
            "gyroscope_z": -131,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.864283800125122,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3057,
            "angle_x": 2.08829665184021,
            "angle_y": -0.688326060771942,
            "angle_z": 2.198812332152258
          },
          "event_time": "20250718T125848Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 74.16666412353516,
  humidity: 34.4899673461914,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 863,
  gyroscope_x: -158,
  gyroscope_y: 52,
  gyroscope_z: -131,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.864283800125122,
  risk_level: 0,
  alarm_active: false,
  uptime: 3057,
  angle_x: 2.08829665184021,
  angle_y: -0.688326060771942,
  angle_z: 2.198812332152258
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:58:48.000Z',
  temperature: 31.52094268798828,
  humidity: 34.4899673461914,
  illumination: 74.16666412353516,
  acceleration_x: 10,
  acceleration_y: 31,
  acceleration_z: 863,
  gyroscope_x: -158,
  gyroscope_y: 52,
  gyroscope_z: -131,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 863.6144973308403,
  gyroscope_total: 211.72859986312668,
  risk_level: 0,
  alarm_active: false,
  uptime: 3057,
  angle_x: 2.08829665184021,
  angle_y: -0.688326060771942,
  angle_z: 2.198812332152258
}
✅ 数据插入成功
插入的记录ID: 13411

⏱️  处理完成，耗时: 486ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备5 (77035712) (179821分钟)
📵 设备离线: 上坪监测设备10 (vice_006) (179183分钟)
📵 设备离线: 下湾监测设备5 (vice_007) (179178分钟)
📵 设备离线: 前岗监测设备5 (vice_008) (179173分钟)
📵 设备离线: 上坪监测设备11 (t_device) (69022分钟)
📵 设备离线: 龙门滑坡监测站 (30分钟)
✅ 历史数据处理完成，最新ID: 1100
=== 收到华为IoT数据 ===
时间: 2025-07-18T12:59:19.458Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125919Z",
  "event_time_ms": "2025-07-18T12:59:19.216Z",
  "request_id": "c79aa5d2-b3de-43fe-9991-1fe9dae2e3d0",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 73.3333282470703,
            "humidity": 34.26413345336914,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 869,
            "gyroscope_x": -155,
            "gyroscope_y": 51,
            "gyroscope_z": -125,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8697312474250793,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3087,
            "angle_x": 2.2522547245025635,
            "angle_y": -0.5553146600723267,
            "angle_z": 2.31970379913802
          },
          "event_time": "20250718T125919Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 73.3333282470703,
  humidity: 34.26413345336914,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -155,
  gyroscope_y: 51,
  gyroscope_z: -125,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8697312474250793,
  risk_level: 0,
  alarm_active: false,
  uptime: 3087,
  angle_x: 2.2522547245025635,
  angle_y: -0.5553146600723267,
  angle_z: 2.31970379913802
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:59:19.000Z',
  temperature: 31.507591247558594,
  humidity: 34.26413345336914,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -155,
  gyroscope_y: 51,
  gyroscope_z: -125,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.7016729890773,
  gyroscope_total: 205.55048041782825,
  risk_level: 0,
  alarm_active: false,
  uptime: 3087,
  angle_x: 2.2522547245025635,
  angle_y: -0.5553146600723267,
  angle_z: 2.31970379913802
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13412

⏱️  处理完成，耗时: 587ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T12:59:49.385Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T125949Z",
  "event_time_ms": "2025-07-18T12:59:49.217Z",
  "request_id": "5b68820c-ba65-45a7-99dc-722668df81f2",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 74.16666412353516,
            "humidity": 34.36484146118164,
            "acceleration_x": 9,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -154,
            "gyroscope_y": 50,
            "gyroscope_z": -128,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8671690225601196,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3117,
            "angle_x": 2.242769718170166,
            "angle_y": -0.6134563088417053,
            "angle_z": 2.3251547586340946
          },
          "event_time": "20250718T125949Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 74.16666412353516,
  humidity: 34.36484146118164,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 50,
  gyroscope_z: -128,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8671690225601196,
  risk_level: 0,
  alarm_active: false,
  uptime: 3117,
  angle_x: 2.242769718170166,
  angle_y: -0.6134563088417053,
  angle_z: 2.3251547586340946
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T12:59:49.000Z',
  temperature: 31.52094268798828,
  humidity: 34.36484146118164,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -154,
  gyroscope_y: 50,
  gyroscope_z: -128,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6752563676894,
  gyroscope_total: 206.39767440550293,
  risk_level: 0,
  alarm_active: false,
  uptime: 3117,
  angle_x: 2.242769718170166,
  angle_y: -0.6134563088417053,
  angle_z: 2.3251547586340946
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13413

⏱️  处理完成，耗时: 1144ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:00:19.563Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130019Z",
  "event_time_ms": "2025-07-18T13:00:19.352Z",
  "request_id": "6474d68a-2d4a-4997-8094-42a5b5318944",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.52094268798828,
            "illumination": 74.16666412353516,
            "humidity": 34.33432388305664,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 866,
            "gyroscope_x": -155,
            "gyroscope_y": 45,
            "gyroscope_z": -134,
            "mpu_temperature": 31.52094268798828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8674089908599854,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3147,
            "angle_x": 2.250218152999878,
            "angle_y": -0.556800663471222,
            "angle_z": 2.318082982753675
          },
          "event_time": "20250718T130019Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.52094268798828,
  illumination: 74.16666412353516,
  humidity: 34.33432388305664,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -155,
  gyroscope_y: 45,
  gyroscope_z: -134,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8674089908599854,
  risk_level: 0,
  alarm_active: false,
  uptime: 3147,
  angle_x: 2.250218152999878,
  angle_y: -0.556800663471222,
  angle_z: 2.318082982753675
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:00:19.000Z',
  temperature: 31.52094268798828,
  humidity: 34.33432388305664,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -155,
  gyroscope_y: 45,
  gyroscope_z: -134,
  mpu_temperature: 31.52094268798828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7041017556107,
  gyroscope_total: 209.77607108533613,
  risk_level: 0,
  alarm_active: false,
  uptime: 3147,
  angle_x: 2.250218152999878,
  angle_y: -0.556800663471222,
  angle_z: 2.318082982753675
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13414

⏱️  处理完成，耗时: 624ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:00:49.579Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130049Z",
  "event_time_ms": "2025-07-18T13:00:49.445Z",
  "request_id": "3862d99f-d4d6-4c7b-b9fb-c3ce11b90f6a",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.411460876464844,
            "illumination": 73.3333282470703,
            "humidity": 34.105438232421875,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 868,
            "gyroscope_x": -151,
            "gyroscope_y": 53,
            "gyroscope_z": -128,
            "mpu_temperature": 31.411460876464844,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868846595287323,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3177,
            "angle_x": 2.2062129974365234,
            "angle_y": -0.5397502779960632,
            "angle_z": 2.271278528198309
          },
          "event_time": "20250718T130049Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.411460876464844,
  illumination: 73.3333282470703,
  humidity: 34.105438232421875,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 53,
  gyroscope_z: -128,
  mpu_temperature: 31.411460876464844,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868846595287323,
  risk_level: 0,
  alarm_active: false,
  uptime: 3177,
  angle_x: 2.2062129974365234,
  angle_y: -0.5397502779960632,
  angle_z: 2.271278528198309
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:00:49.000Z',
  temperature: 31.411460876464844,
  humidity: 34.105438232421875,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 868,
  gyroscope_x: -151,
  gyroscope_y: 53,
  gyroscope_z: -128,
  mpu_temperature: 31.411460876464844,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.6639165983586,
  gyroscope_total: 204.9243762952568,
  risk_level: 0,
  alarm_active: false,
  uptime: 3177,
  angle_x: 2.2062129974365234,
  angle_y: -0.5397502779960632,
  angle_z: 2.271278528198309
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13415

⏱️  处理完成，耗时: 960ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:01:19.774Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130119Z",
  "event_time_ms": "2025-07-18T13:01:19.618Z",
  "request_id": "057ec418-d4b3-4ebd-8fff-f1dd9bdae5c4",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.39543914794922,
            "illumination": 74.16666412353516,
            "humidity": 34.35263442993164,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 867,
            "gyroscope_x": -152,
            "gyroscope_y": 44,
            "gyroscope_z": -131,
            "mpu_temperature": 31.39543914794922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.867761790752411,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3207,
            "angle_x": 2.225104331970215,
            "angle_y": -0.5646311044692993,
            "angle_z": 2.2956257474350727
          },
          "event_time": "20250718T130119Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.39543914794922,
  illumination: 74.16666412353516,
  humidity: 34.35263442993164,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -152,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.39543914794922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.867761790752411,
  risk_level: 0,
  alarm_active: false,
  uptime: 3207,
  angle_x: 2.225104331970215,
  angle_y: -0.5646311044692993,
  angle_z: 2.2956257474350727
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:01:19.000Z',
  temperature: 31.39543914794922,
  humidity: 34.35263442993164,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -152,
  gyroscope_y: 44,
  gyroscope_z: -131,
  mpu_temperature: 31.39543914794922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.664681775166,
  gyroscope_total: 205.4288197892399,
  risk_level: 0,
  alarm_active: false,
  uptime: 3207,
  angle_x: 2.225104331970215,
  angle_y: -0.5646311044692993,
  angle_z: 2.2956257474350727
}
✅ 数据插入成功
插入的记录ID: 13416

⏱️  处理完成，耗时: 402ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:01:50.184Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130150Z",
  "event_time_ms": "2025-07-18T13:01:50.067Z",
  "request_id": "55f2b366-914f-4fca-8d8f-303ea6dfa3e7",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.42481231689453,
            "illumination": 73.3333282470703,
            "humidity": 34.3114356994629,
            "acceleration_x": 10,
            "acceleration_y": 34,
            "acceleration_z": 867,
            "gyroscope_x": -155,
            "gyroscope_y": 49,
            "gyroscope_z": -131,
            "mpu_temperature": 31.42481231689453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.86867356300354,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3238,
            "angle_x": 2.2791717052459717,
            "angle_y": -0.7091098427772522,
            "angle_z": 2.3869353638331745
          },
          "event_time": "20250718T130150Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.42481231689453,
  illumination: 73.3333282470703,
  humidity: 34.3114356994629,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -155,
  gyroscope_y: 49,
  gyroscope_z: -131,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.86867356300354,
  risk_level: 0,
  alarm_active: false,
  uptime: 3238,
  angle_x: 2.2791717052459717,
  angle_y: -0.7091098427772522,
  angle_z: 2.3869353638331745
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:01:50.000Z',
  temperature: 31.42481231689453,
  humidity: 34.3114356994629,
  illumination: 73.3333282470703,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -155,
  gyroscope_y: 49,
  gyroscope_z: -131,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.7240344717899,
  gyroscope_total: 208.77499850317326,
  risk_level: 0,
  alarm_active: false,
  uptime: 3238,
  angle_x: 2.2791717052459717,
  angle_y: -0.7091098427772522,
  angle_z: 2.3869353638331745
}
✅ 数据插入成功
插入的记录ID: 13417

⏱️  处理完成，耗时: 387ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 1200
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:02:20.347Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130220Z",
  "event_time_ms": "2025-07-18T13:02:20.188Z",
  "request_id": "da193a1f-9f78-41ff-80f7-40515c492b54",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.43816375732422,
            "illumination": 73.3333282470703,
            "humidity": 34.5113296508789,
            "acceleration_x": 6,
            "acceleration_y": 32,
            "acceleration_z": 864,
            "gyroscope_x": -160,
            "gyroscope_y": 42,
            "gyroscope_z": -129,
            "mpu_temperature": 31.43816375732422,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8650275468826294,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3268,
            "angle_x": 2.1755013465881348,
            "angle_y": -0.4288404881954193,
            "angle_z": 2.217365615617432
          },
          "event_time": "20250718T130220Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.43816375732422,
  illumination: 73.3333282470703,
  humidity: 34.5113296508789,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -160,
  gyroscope_y: 42,
  gyroscope_z: -129,
  mpu_temperature: 31.43816375732422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8650275468826294,
  risk_level: 0,
  alarm_active: false,
  uptime: 3268,
  angle_x: 2.1755013465881348,
  angle_y: -0.4288404881954193,
  angle_z: 2.217365615617432
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:02:20.000Z',
  temperature: 31.43816375732422,
  humidity: 34.5113296508789,
  illumination: 73.3333282470703,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 864,
  gyroscope_x: -160,
  gyroscope_y: 42,
  gyroscope_z: -129,
  mpu_temperature: 31.43816375732422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 864.6132083191883,
  gyroscope_total: 209.77368757782756,
  risk_level: 0,
  alarm_active: false,
  uptime: 3268,
  angle_x: 2.1755013465881348,
  angle_y: -0.4288404881954193,
  angle_z: 2.217365615617432
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13418

⏱️  处理完成，耗时: 1531ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:02:50.602Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130250Z",
  "event_time_ms": "2025-07-18T13:02:50.437Z",
  "request_id": "7948c636-36fc-4900-a4de-0d608033f912",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.42481231689453,
            "illumination": 73.3333282470703,
            "humidity": 34.467079162597656,
            "acceleration_x": 10,
            "acceleration_y": 34,
            "acceleration_z": 870,
            "gyroscope_x": -156,
            "gyroscope_y": 42,
            "gyroscope_z": -128,
            "mpu_temperature": 31.42481231689453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8708630800247192,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3298,
            "angle_x": 2.2734384536743164,
            "angle_y": -0.6751714944839478,
            "angle_z": 2.3715773125936153
          },
          "event_time": "20250718T130250Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.42481231689453,
  illumination: 73.3333282470703,
  humidity: 34.467079162597656,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 870,
  gyroscope_x: -156,
  gyroscope_y: 42,
  gyroscope_z: -128,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8708630800247192,
  risk_level: 0,
  alarm_active: false,
  uptime: 3298,
  angle_x: 2.2734384536743164,
  angle_y: -0.6751714944839478,
  angle_z: 2.3715773125936153
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:02:50.000Z',
  temperature: 31.42481231689453,
  humidity: 34.467079162597656,
  illumination: 73.3333282470703,
  acceleration_x: 10,
  acceleration_y: 34,
  acceleration_z: 870,
  gyroscope_x: -156,
  gyroscope_y: 42,
  gyroscope_z: -128,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 870.7215398736843,
  gyroscope_total: 206.11647192788837,
  risk_level: 0,
  alarm_active: false,
  uptime: 3298,
  angle_x: 2.2734384536743164,
  angle_y: -0.6751714944839478,
  angle_z: 2.3715773125936153
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13419

⏱️  处理完成，耗时: 1441ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
❌ 更新风险趋势失败: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:12637:11\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async DataProcessor.updateRiskTrends (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:356:27)\n' +
    '    at async DataProcessor.processNewData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:168:7)\n' +
    '    at async DataProcessor.processHistoricalData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:398:11)',
  hint: '',
  code: ''
}
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:03:20.824Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130320Z",
  "event_time_ms": "2025-07-18T13:03:20.646Z",
  "request_id": "1cf58315-b53c-4a48-9659-3bba15dd14c8",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.38208770751953,
            "illumination": 73.3333282470703,
            "humidity": 34.81803512573242,
            "acceleration_x": 8,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -149,
            "gyroscope_y": 51,
            "gyroscope_z": -127,
            "mpu_temperature": 31.38208770751953,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.866910457611084,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3328,
            "angle_x": 2.2272911071777344,
            "angle_y": -0.581335186958313,
            "angle_z": 2.3019070953687235
          },
          "event_time": "20250718T130320Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.38208770751953,
  illumination: 73.3333282470703,
  humidity: 34.81803512573242,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -149,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.38208770751953,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.866910457611084,
  risk_level: 0,
  alarm_active: false,
  uptime: 3328,
  angle_x: 2.2272911071777344,
  angle_y: -0.581335186958313,
  angle_z: 2.3019070953687235
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:03:20.000Z',
  temperature: 31.38208770751953,
  humidity: 34.81803512573242,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -149,
  gyroscope_y: 51,
  gyroscope_z: -127,
  mpu_temperature: 31.38208770751953,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6654487170929,
  gyroscope_total: 202.3141122116794,
  risk_level: 0,
  alarm_active: false,
  uptime: 3328,
  angle_x: 2.2272911071777344,
  angle_y: -0.581335186958313,
  angle_z: 2.3019070953687235
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13420

⏱️  处理完成，耗时: 619ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:03:50.916Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130350Z",
  "event_time_ms": "2025-07-18T13:03:50.762Z",
  "request_id": "12bd41bd-0b46-4505-8f90-1e52ed01e773",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.411460876464844,
            "illumination": 73.3333282470703,
            "humidity": 35.1583137512207,
            "acceleration_x": 6,
            "acceleration_y": 32,
            "acceleration_z": 868,
            "gyroscope_x": -159,
            "gyroscope_y": 54,
            "gyroscope_z": -125,
            "mpu_temperature": 31.411460876464844,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8691593408584595,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3358,
            "angle_x": 2.132944107055664,
            "angle_y": -0.4509482979774475,
            "angle_z": 2.1800928721667434
          },
          "event_time": "20250718T130350Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.411460876464844,
  illumination: 73.3333282470703,
  humidity: 35.1583137512207,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -159,
  gyroscope_y: 54,
  gyroscope_z: -125,
  mpu_temperature: 31.411460876464844,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8691593408584595,
  risk_level: 0,
  alarm_active: false,
  uptime: 3358,
  angle_x: 2.132944107055664,
  angle_y: -0.4509482979774475,
  angle_z: 2.1800928721667434
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:03:50.000Z',
  temperature: 31.411460876464844,
  humidity: 35.1583137512207,
  illumination: 73.3333282470703,
  acceleration_x: 6,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -159,
  gyroscope_y: 54,
  gyroscope_z: -125,
  mpu_temperature: 31.411460876464844,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.6103844647496,
  gyroscope_total: 209.33704879929877,
  risk_level: 0,
  alarm_active: false,
  uptime: 3358,
  angle_x: 2.132944107055664,
  angle_y: -0.4509482979774475,
  angle_z: 2.1800928721667434
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13421

⏱️  处理完成，耗时: 623ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔍 检查设备离线状态...
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备6 (77035712) (179826分钟)
📵 设备离线: 上坪监测设备12 (vice_006) (179188分钟)
📵 设备离线: 下湾监测设备6 (vice_007) (179183分钟)
📵 设备离线: 前岗监测设备6 (vice_008) (179178分钟)
📵 设备离线: 上坪监测设备13 (t_device) (69027分钟)
📵 设备离线: 龙门滑坡监测站 (35分钟)
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:04:21.126Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130420Z",
  "event_time_ms": "2025-07-18T13:04:20.933Z",
  "request_id": "92deee2b-e46c-4ba3-a593-3df876aea27c",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.42481231689453,
            "illumination": 73.3333282470703,
            "humidity": 35.55199432373047,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 865,
            "gyroscope_x": -160,
            "gyroscope_y": 54,
            "gyroscope_z": -129,
            "mpu_temperature": 31.42481231689453,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8663929104804993,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3388,
            "angle_x": 2.1639931201934814,
            "angle_y": -0.630131185054779,
            "angle_z": 2.2538703455663236
          },
          "event_time": "20250718T130420Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.42481231689453,
  illumination: 73.3333282470703,
  humidity: 35.55199432373047,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 865,
  gyroscope_x: -160,
  gyroscope_y: 54,
  gyroscope_z: -129,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8663929104804993,
  risk_level: 0,
  alarm_active: false,
  uptime: 3388,
  angle_x: 2.1639931201934814,
  angle_y: -0.630131185054779,
  angle_z: 2.2538703455663236
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:04:20.000Z',
  temperature: 31.42481231689453,
  humidity: 35.55199432373047,
  illumination: 73.3333282470703,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 865,
  gyroscope_x: -160,
  gyroscope_y: 54,
  gyroscope_z: -129,
  mpu_temperature: 31.42481231689453,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.6384926746268,
  gyroscope_total: 212.50176469855492,
  risk_level: 0,
  alarm_active: false,
  uptime: 3388,
  angle_x: 2.1639931201934814,
  angle_y: -0.630131185054779,
  angle_z: 2.2538703455663236
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13422

⏱️  处理完成，耗时: 628ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

❌ 更新风险趋势失败: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:12637:11\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async DataProcessor.updateRiskTrends (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:356:27)\n' +
    '    at async DataProcessor.processNewData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:168:7)\n' +
    '    at async DataProcessor.processHistoricalData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:398:11)',
  hint: '',
  code: ''
}
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:04:51.105Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130450Z",
  "event_time_ms": "2025-07-18T13:04:50.947Z",
  "request_id": "88a5e9b1-cee8-428b-9f3b-c1349991b483",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.464866638183594,
            "illumination": 73.3333282470703,
            "humidity": 36.0921630859375,
            "acceleration_x": 7,
            "acceleration_y": 33,
            "acceleration_z": 865,
            "gyroscope_x": -148,
            "gyroscope_y": 43,
            "gyroscope_z": -128,
            "mpu_temperature": 31.464866638183594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8660436272621155,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3418,
            "angle_x": 2.2214391231536865,
            "angle_y": -0.5253379940986633,
            "angle_z": 2.2827114986176915
          },
          "event_time": "20250718T130450Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.464866638183594,
  illumination: 73.3333282470703,
  humidity: 36.0921630859375,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 865,
  gyroscope_x: -148,
  gyroscope_y: 43,
  gyroscope_z: -128,
  mpu_temperature: 31.464866638183594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8660436272621155,
  risk_level: 0,
  alarm_active: false,
  uptime: 3418,
  angle_x: 2.2214391231536865,
  angle_y: -0.5253379940986633,
  angle_z: 2.2827114986176915
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:04:50.000Z',
  temperature: 31.464866638183594,
  humidity: 36.0921630859375,
  illumination: 73.3333282470703,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 865,
  gyroscope_x: -148,
  gyroscope_y: 43,
  gyroscope_z: -128,
  mpu_temperature: 31.464866638183594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.6575535395044,
  gyroscope_total: 200.3422072355199,
  risk_level: 0,
  alarm_active: false,
  uptime: 3418,
  angle_x: 2.2214391231536865,
  angle_y: -0.5253379940986633,
  angle_z: 2.2827114986176915
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13423

⏱️  处理完成，耗时: 646ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:05:21.518Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130521Z",
  "event_time_ms": "2025-07-18T13:05:21.307Z",
  "request_id": "baa96393-51e8-4416-bc70-028800888d08",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.507591247558594,
            "illumination": 73.3333282470703,
            "humidity": 36.54840850830078,
            "acceleration_x": 8,
            "acceleration_y": 36,
            "acceleration_z": 867,
            "gyroscope_x": -147,
            "gyroscope_y": 49,
            "gyroscope_z": -130,
            "mpu_temperature": 31.507591247558594,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8681102395057678,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3449,
            "angle_x": 2.3935394287109375,
            "angle_y": -0.572535514831543,
            "angle_z": 2.4610623544594112
          },
          "event_time": "20250718T130521Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.507591247558594,
  illumination: 73.3333282470703,
  humidity: 36.54840850830078,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 867,
  gyroscope_x: -147,
  gyroscope_y: 49,
  gyroscope_z: -130,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8681102395057678,
  risk_level: 0,
  alarm_active: false,
  uptime: 3449,
  angle_x: 2.3935394287109375,
  angle_y: -0.572535514831543,
  angle_z: 2.4610623544594112
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:05:21.000Z',
  temperature: 31.507591247558594,
  humidity: 36.54840850830078,
  illumination: 73.3333282470703,
  acceleration_x: 8,
  acceleration_y: 36,
  acceleration_z: 867,
  gyroscope_x: -147,
  gyroscope_y: 49,
  gyroscope_z: -130,
  mpu_temperature: 31.507591247558594,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.7839592894074,
  gyroscope_total: 202.26220605936246,
  risk_level: 0,
  alarm_active: false,
  uptime: 3449,
  angle_x: 2.3935394287109375,
  angle_y: -0.572535514831543,
  angle_z: 2.4610623544594112
}
✅ 数据插入成功
插入的记录ID: 13424

⏱️  处理完成，耗时: 515ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 1300
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:05:51.521Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130551Z",
  "event_time_ms": "2025-07-18T13:05:51.407Z",
  "request_id": "be3fd470-7cb2-41d4-8c7a-24bf03a270a2",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 73.3333282470703,
            "humidity": 37.04432678222656,
            "acceleration_x": 7,
            "acceleration_y": 33,
            "acceleration_z": 867,
            "gyroscope_x": -158,
            "gyroscope_y": 57,
            "gyroscope_z": -131,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8685957193374634,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3478,
            "angle_x": 2.1987926959991455,
            "angle_y": -0.52378648519516,
            "angle_z": 2.2603189160055024
          },
          "event_time": "20250718T130551Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 73.3333282470703,
  humidity: 37.04432678222656,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -158,
  gyroscope_y: 57,
  gyroscope_z: -131,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8685957193374634,
  risk_level: 0,
  alarm_active: false,
  uptime: 3478,
  angle_x: 2.1987926959991455,
  angle_y: -0.52378648519516,
  angle_z: 2.2603189160055024
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:05:51.000Z',
  temperature: 31.536964416503906,
  humidity: 37.04432678222656,
  illumination: 73.3333282470703,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -158,
  gyroscope_y: 57,
  gyroscope_z: -131,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6560378398805,
  gyroscope_total: 213.01173676584114,
  risk_level: 0,
  alarm_active: false,
  uptime: 3478,
  angle_x: 2.1987926959991455,
  angle_y: -0.52378648519516,
  angle_z: 2.2603189160055024
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13425

⏱️  处理完成，耗时: 1289ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:06:21.586Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130621Z",
  "event_time_ms": "2025-07-18T13:06:21.392Z",
  "request_id": "ece389ae-56c9-4c42-a665-8ddf362c2908",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.536964416503906,
            "illumination": 73.3333282470703,
            "humidity": 37.396812438964844,
            "acceleration_x": 5,
            "acceleration_y": 34,
            "acceleration_z": 867,
            "gyroscope_x": -153,
            "gyroscope_y": 47,
            "gyroscope_z": -134,
            "mpu_temperature": 31.536964416503906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8686071038246155,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3509,
            "angle_x": 2.2551708221435547,
            "angle_y": -0.3303939402103424,
            "angle_z": 2.279244522374761
          },
          "event_time": "20250718T130621Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.536964416503906,
  illumination: 73.3333282470703,
  humidity: 37.396812438964844,
  acceleration_x: 5,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 47,
  gyroscope_z: -134,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8686071038246155,
  risk_level: 0,
  alarm_active: false,
  uptime: 3509,
  angle_x: 2.2551708221435547,
  angle_y: -0.3303939402103424,
  angle_z: 2.279244522374761
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:06:21.000Z',
  temperature: 31.536964416503906,
  humidity: 37.396812438964844,
  illumination: 73.3333282470703,
  acceleration_x: 5,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -153,
  gyroscope_y: 47,
  gyroscope_z: -134,
  mpu_temperature: 31.536964416503906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6808168906352,
  gyroscope_total: 208.7438621852149,
  risk_level: 0,
  alarm_active: false,
  uptime: 3509,
  angle_x: 2.2551708221435547,
  angle_y: -0.3303939402103424,
  angle_z: 2.279244522374761
}
✅ 数据插入成功
插入的记录ID: 13426

⏱️  处理完成，耗时: 389ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:06:51.685Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130651Z",
  "event_time_ms": "2025-07-18T13:06:51.510Z",
  "request_id": "96ad2c0c-df55-46ca-a133-b0c2dad043f4",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.56633758544922,
            "illumination": 73.3333282470703,
            "humidity": 37.6531639099121,
            "acceleration_x": 10,
            "acceleration_y": 33,
            "acceleration_z": 866,
            "gyroscope_x": -158,
            "gyroscope_y": 53,
            "gyroscope_z": -131,
            "mpu_temperature": 31.56633758544922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8669166564941406,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3538,
            "angle_x": 2.194979429244995,
            "angle_y": -0.7266549468040466,
            "angle_z": 2.3121336696920176
          },
          "event_time": "20250718T130651Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.56633758544922,
  illumination: 73.3333282470703,
  humidity: 37.6531639099121,
  acceleration_x: 10,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 53,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8669166564941406,
  risk_level: 0,
  alarm_active: false,
  uptime: 3538,
  angle_x: 2.194979429244995,
  angle_y: -0.7266549468040466,
  angle_z: 2.3121336696920176
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:06:51.000Z',
  temperature: 31.56633758544922,
  humidity: 37.6531639099121,
  illumination: 73.3333282470703,
  acceleration_x: 10,
  acceleration_y: 33,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 53,
  gyroscope_z: -131,
  mpu_temperature: 31.56633758544922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.6862177281926,
  gyroscope_total: 211.97641378228852,
  risk_level: 0,
  alarm_active: false,
  uptime: 3538,
  angle_x: 2.194979429244995,
  angle_y: -0.7266549468040466,
  angle_z: 2.3121336696920176
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13427

⏱️  处理完成，耗时: 1015ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

❌ 更新风险趋势失败: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:12637:11\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async DataProcessor.updateRiskTrends (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:356:27)\n' +
    '    at async DataProcessor.processNewData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:168:7)\n' +
    '    at async DataProcessor.processHistoricalData (/home/k7/Landslide_monitor/web/backend/iot-service/data-processor.js:398:11)',
  hint: '',
  code: ''
}
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:07:21.885Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130721Z",
  "event_time_ms": "2025-07-18T13:07:21.727Z",
  "request_id": "c15db035-8ce3-4180-9d3a-367df5d6e215",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.60906219482422,
            "illumination": 74.16666412353516,
            "humidity": 37.882049560546875,
            "acceleration_x": 7,
            "acceleration_y": 34,
            "acceleration_z": 869,
            "gyroscope_x": -152,
            "gyroscope_y": 45,
            "gyroscope_z": -130,
            "mpu_temperature": 31.60906219482422,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.87032949924469,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3569,
            "angle_x": 2.2426633834838867,
            "angle_y": -0.5066731572151184,
            "angle_z": 2.29918610379015
          },
          "event_time": "20250718T130721Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.60906219482422,
  illumination: 74.16666412353516,
  humidity: 37.882049560546875,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -152,
  gyroscope_y: 45,
  gyroscope_z: -130,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.87032949924469,
  risk_level: 0,
  alarm_active: false,
  uptime: 3569,
  angle_x: 2.2426633834838867,
  angle_y: -0.5066731572151184,
  angle_z: 2.29918610379015
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:07:21.000Z',
  temperature: 31.60906219482422,
  humidity: 37.882049560546875,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -152,
  gyroscope_y: 45,
  gyroscope_z: -130,
  mpu_temperature: 31.60906219482422,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.693049299579,
  gyroscope_total: 205.00975586542216,
  risk_level: 0,
  alarm_active: false,
  uptime: 3569,
  angle_x: 2.2426633834838867,
  angle_y: -0.5066731572151184,
  angle_z: 2.29918610379015
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13428

⏱️  处理完成，耗时: 642ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:07:52.124Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130751Z",
  "event_time_ms": "2025-07-18T13:07:51.985Z",
  "request_id": "38fc3ceb-8153-4d4d-a392-896aa03a583c",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.622413635253906,
            "illumination": 74.16666412353516,
            "humidity": 38.34897232055664,
            "acceleration_x": 7,
            "acceleration_y": 34,
            "acceleration_z": 869,
            "gyroscope_x": -158,
            "gyroscope_y": 52,
            "gyroscope_z": -130,
            "mpu_temperature": 31.622413635253906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.869744896888733,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3599,
            "angle_x": 2.28441071510315,
            "angle_y": -0.515076756477356,
            "angle_z": 2.341759249013723
          },
          "event_time": "20250718T130751Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.622413635253906,
  illumination: 74.16666412353516,
  humidity: 38.34897232055664,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -158,
  gyroscope_y: 52,
  gyroscope_z: -130,
  mpu_temperature: 31.622413635253906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.869744896888733,
  risk_level: 0,
  alarm_active: false,
  uptime: 3599,
  angle_x: 2.28441071510315,
  angle_y: -0.515076756477356,
  angle_z: 2.341759249013723
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:07:51.000Z',
  temperature: 31.622413635253906,
  humidity: 38.34897232055664,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 34,
  acceleration_z: 869,
  gyroscope_x: -158,
  gyroscope_y: 52,
  gyroscope_z: -130,
  mpu_temperature: 31.622413635253906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.693049299579,
  gyroscope_total: 211.11134502911017,
  risk_level: 0,
  alarm_active: false,
  uptime: 3599,
  angle_x: 2.28441071510315,
  angle_y: -0.515076756477356,
  angle_z: 2.341759249013723
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13429

⏱️  处理完成，耗时: 592ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 1400
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:08:22.615Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130822Z",
  "event_time_ms": "2025-07-18T13:08:22.467Z",
  "request_id": "90e37412-3490-466e-a0a2-8de713408760",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.579689025878906,
            "illumination": 74.16666412353516,
            "humidity": 38.570228576660156,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 872,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -131,
            "mpu_temperature": 31.579689025878906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8734156489372253,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3629,
            "angle_x": 2.2828187942504883,
            "angle_y": -0.560998260974884,
            "angle_z": 2.3507404570050046
          },
          "event_time": "20250718T130822Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.579689025878906,
  illumination: 74.16666412353516,
  humidity: 38.570228576660156,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 872,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -131,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8734156489372253,
  risk_level: 0,
  alarm_active: false,
  uptime: 3629,
  angle_x: 2.2828187942504883,
  angle_y: -0.560998260974884,
  angle_z: 2.3507404570050046
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:08:22.000Z',
  temperature: 31.579689025878906,
  humidity: 38.570228576660156,
  illumination: 74.16666412353516,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 872,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -131,
  mpu_temperature: 31.579689025878906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 872.6992609140906,
  gyroscope_total: 207.12797976130602,
  risk_level: 0,
  alarm_active: false,
  uptime: 3629,
  angle_x: 2.2828187942504883,
  angle_y: -0.560998260974884,
  angle_z: 2.3507404570050046
}
✅ 数据插入成功
插入的记录ID: 13430

⏱️  处理完成，耗时: 756ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
🔍 检查设备离线状态...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:08:52.478Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130852Z",
  "event_time_ms": "2025-07-18T13:08:52.317Z",
  "request_id": "c8c15807-078f-4014-96f7-5446860fe5e1",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.65178680419922,
            "illumination": 73.3333282470703,
            "humidity": 38.6205825805664,
            "acceleration_x": 7,
            "acceleration_y": 33,
            "acceleration_z": 869,
            "gyroscope_x": -157,
            "gyroscope_y": 39,
            "gyroscope_z": -126,
            "mpu_temperature": 31.65178680419922,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8699294924736023,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3659,
            "angle_x": 2.1873738765716553,
            "angle_y": -0.4988412857055664,
            "angle_z": 2.24353451148684
          },
          "event_time": "20250718T130852Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.65178680419922,
  illumination: 73.3333282470703,
  humidity: 38.6205825805664,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 869,
  gyroscope_x: -157,
  gyroscope_y: 39,
  gyroscope_z: -126,
  mpu_temperature: 31.65178680419922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8699294924736023,
  risk_level: 0,
  alarm_active: false,
  uptime: 3659,
  angle_x: 2.1873738765716553,
  angle_y: -0.4988412857055664,
  angle_z: 2.24353451148684
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:08:52.000Z',
  temperature: 31.65178680419922,
  humidity: 38.6205825805664,
  illumination: 73.3333282470703,
  acceleration_x: 7,
  acceleration_y: 33,
  acceleration_z: 869,
  gyroscope_x: -157,
  gyroscope_y: 39,
  gyroscope_z: -126,
  mpu_temperature: 31.65178680419922,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 869.654529109117,
  gyroscope_total: 205.05121311516302,
  risk_level: 0,
  alarm_active: false,
  uptime: 3659,
  angle_x: 2.1873738765716553,
  angle_y: -0.4988412857055664,
  angle_z: 2.24353451148684
}
⚠️  发现 6 个离线设备
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13431

⏱️  处理完成，耗时: 1492ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

🔄 处理 100 条历史数据...
📵 设备离线: 兰草监测设备7 (77035712) (179831分钟)
📵 设备离线: 上坪监测设备14 (vice_006) (179193分钟)
📵 设备离线: 下湾监测设备7 (vice_007) (179188分钟)
📵 设备离线: 前岗监测设备7 (vice_008) (179183分钟)
📵 设备离线: 上坪监测设备15 (t_device) (69032分钟)
📵 设备离线: 龙门滑坡监测站 (40分钟)
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:09:22.678Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130922Z",
  "event_time_ms": "2025-07-18T13:09:22.327Z",
  "request_id": "4e284b17-9805-42f9-abd2-907dfe713023",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.707862854003906,
            "illumination": 74.16666412353516,
            "humidity": 38.87998962402344,
            "acceleration_x": 7,
            "acceleration_y": 32,
            "acceleration_z": 868,
            "gyroscope_x": -160,
            "gyroscope_y": 48,
            "gyroscope_z": -131,
            "mpu_temperature": 31.707862854003906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868822455406189,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3689,
            "angle_x": 2.174050807952881,
            "angle_y": -0.4994724690914154,
            "angle_z": 2.2306881590533556
          },
          "event_time": "20250718T130922Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.707862854003906,
  illumination: 74.16666412353516,
  humidity: 38.87998962402344,
  acceleration_x: 7,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -160,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868822455406189,
  risk_level: 0,
  alarm_active: false,
  uptime: 3689,
  angle_x: 2.174050807952881,
  angle_y: -0.4994724690914154,
  angle_z: 2.2306881590533556
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:09:22.000Z',
  temperature: 31.707862854003906,
  humidity: 38.87998962402344,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 32,
  acceleration_z: 868,
  gyroscope_x: -160,
  gyroscope_y: 48,
  gyroscope_z: -131,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.6178676495206,
  gyroscope_total: 212.2851855405836,
  risk_level: 0,
  alarm_active: false,
  uptime: 3689,
  angle_x: 2.174050807952881,
  angle_y: -0.4994724690914154,
  angle_z: 2.2306881590533556
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13432

⏱️  处理完成，耗时: 630ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:09:52.700Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T130952Z",
  "event_time_ms": "2025-07-18T13:09:52.537Z",
  "request_id": "c5820fae-dc52-4a3b-9a4f-5caeda79dcf3",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.69184112548828,
            "illumination": 74.16666412353516,
            "humidity": 39.51323699951172,
            "acceleration_x": 9,
            "acceleration_y": 32,
            "acceleration_z": 870,
            "gyroscope_x": -148,
            "gyroscope_y": 51,
            "gyroscope_z": -135,
            "mpu_temperature": 31.69184112548828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.87090927362442,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3719,
            "angle_x": 2.1608023643493652,
            "angle_y": -0.6188250184059143,
            "angle_z": 2.2476679606167114
          },
          "event_time": "20250718T130952Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.69184112548828,
  illumination: 74.16666412353516,
  humidity: 39.51323699951172,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 870,
  gyroscope_x: -148,
  gyroscope_y: 51,
  gyroscope_z: -135,
  mpu_temperature: 31.69184112548828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.87090927362442,
  risk_level: 0,
  alarm_active: false,
  uptime: 3719,
  angle_x: 2.1608023643493652,
  angle_y: -0.6188250184059143,
  angle_z: 2.2476679606167114
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:09:52.000Z',
  temperature: 31.69184112548828,
  humidity: 39.51323699951172,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 32,
  acceleration_z: 870,
  gyroscope_x: -148,
  gyroscope_y: 51,
  gyroscope_z: -135,
  mpu_temperature: 31.69184112548828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 870.6348258598435,
  gyroscope_total: 206.71236053995418,
  risk_level: 0,
  alarm_active: false,
  uptime: 3719,
  angle_x: 2.1608023643493652,
  angle_y: -0.6188250184059143,
  angle_z: 2.2476679606167114
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13433

⏱️  处理完成，耗时: 638ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:10:23.099Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131022Z",
  "event_time_ms": "2025-07-18T13:10:22.662Z",
  "request_id": "4c2a68bc-61ff-4c2a-8ee4-30ea7d84d4c0",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.69184112548828,
            "illumination": 74.16666412353516,
            "humidity": 39.61241912841797,
            "acceleration_x": 7,
            "acceleration_y": 35,
            "acceleration_z": 868,
            "gyroscope_x": -157,
            "gyroscope_y": 46,
            "gyroscope_z": -126,
            "mpu_temperature": 31.69184112548828,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8691553473472595,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3749,
            "angle_x": 2.3262290954589844,
            "angle_y": -0.48322537541389465,
            "angle_z": 2.3758890058257824
          },
          "event_time": "20250718T131022Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.69184112548828,
  illumination: 74.16666412353516,
  humidity: 39.61241912841797,
  acceleration_x: 7,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -157,
  gyroscope_y: 46,
  gyroscope_z: -126,
  mpu_temperature: 31.69184112548828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8691553473472595,
  risk_level: 0,
  alarm_active: false,
  uptime: 3749,
  angle_x: 2.3262290954589844,
  angle_y: -0.48322537541389465,
  angle_z: 2.3758890058257824
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:10:22.000Z',
  temperature: 31.69184112548828,
  humidity: 39.61241912841797,
  illumination: 74.16666412353516,
  acceleration_x: 7,
  acceleration_y: 35,
  acceleration_z: 868,
  gyroscope_x: -157,
  gyroscope_y: 46,
  gyroscope_z: -126,
  mpu_temperature: 31.69184112548828,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 868.7335609955448,
  gyroscope_total: 206.49697334343668,
  risk_level: 0,
  alarm_active: false,
  uptime: 3749,
  angle_x: 2.3262290954589844,
  angle_y: -0.48322537541389465,
  angle_z: 2.3758890058257824
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13434

⏱️  处理完成，耗时: 648ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:10:52.926Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131052Z",
  "event_time_ms": "2025-07-18T13:10:52.762Z",
  "request_id": "e6534203-09e1-4dcf-a130-96bee36550ed",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.707862854003906,
            "illumination": 73.3333282470703,
            "humidity": 39.96490478515625,
            "acceleration_x": 11,
            "acceleration_y": 34,
            "acceleration_z": 867,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -129,
            "mpu_temperature": 31.707862854003906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868069887161255,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3779,
            "angle_x": 2.2726941108703613,
            "angle_y": -0.7660486102104187,
            "angle_z": 2.398326290309585
          },
          "event_time": "20250718T131052Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.707862854003906,
  illumination: 73.3333282470703,
  humidity: 39.96490478515625,
  acceleration_x: 11,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -129,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868069887161255,
  risk_level: 0,
  alarm_active: false,
  uptime: 3779,
  angle_x: 2.2726941108703613,
  angle_y: -0.7660486102104187,
  angle_z: 2.398326290309585
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:10:52.000Z',
  temperature: 31.707862854003906,
  humidity: 39.96490478515625,
  illumination: 73.3333282470703,
  acceleration_x: 11,
  acceleration_y: 34,
  acceleration_z: 867,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -129,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.736135008794,
  gyroscope_total: 205.8688903161427,
  risk_level: 0,
  alarm_active: false,
  uptime: 3779,
  angle_x: 2.2726941108703613,
  angle_y: -0.7660486102104187,
  angle_z: 2.398326290309585
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13435

⏱️  处理完成，耗时: 1132ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:11:23.166Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131122Z",
  "event_time_ms": "2025-07-18T13:11:22.972Z",
  "request_id": "5f29fe1f-c3fa-42b3-887e-36dd5782c11c",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.74791717529297,
            "illumination": 74.16666412353516,
            "humidity": 39.813838958740234,
            "acceleration_x": 9,
            "acceleration_y": 34,
            "acceleration_z": 870,
            "gyroscope_x": -154,
            "gyroscope_y": 45,
            "gyroscope_z": -128,
            "mpu_temperature": 31.74791717529297,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.871210277080536,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3810,
            "angle_x": 2.2484290599823,
            "angle_y": -0.6507863998413086,
            "angle_z": 2.340717021767326
          },
          "event_time": "20250718T131122Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.74791717529297,
  illumination: 74.16666412353516,
  humidity: 39.813838958740234,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 870,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.74791717529297,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.871210277080536,
  risk_level: 0,
  alarm_active: false,
  uptime: 3810,
  angle_x: 2.2484290599823,
  angle_y: -0.6507863998413086,
  angle_z: 2.340717021767326
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:11:22.000Z',
  temperature: 31.74791717529297,
  humidity: 39.813838958740234,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 870,
  gyroscope_x: -154,
  gyroscope_y: 45,
  gyroscope_z: -128,
  mpu_temperature: 31.74791717529297,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 870.7106293137807,
  gyroscope_total: 205.24375751773792,
  risk_level: 0,
  alarm_active: false,
  uptime: 3810,
  angle_x: 2.2484290599823,
  angle_y: -0.6507863998413086,
  angle_z: 2.340717021767326
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13436

⏱️  处理完成，耗时: 1693ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

✅ 历史数据处理完成，最新ID: 1500
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:11:53.258Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131153Z",
  "event_time_ms": "2025-07-18T13:11:53.102Z",
  "request_id": "7bbc19fd-5a45-4e36-b2d6-ed29591cda7d",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.707862854003906,
            "illumination": 74.16666412353516,
            "humidity": 40.303653717041016,
            "acceleration_x": 11,
            "acceleration_y": 29,
            "acceleration_z": 862,
            "gyroscope_x": -188,
            "gyroscope_y": 22,
            "gyroscope_z": -123,
            "mpu_temperature": 31.707862854003906,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8628768920898438,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3839,
            "angle_x": 1.9457118511199951,
            "angle_y": -0.754275143146515,
            "angle_z": 2.0867979296418455
          },
          "event_time": "20250718T131153Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.707862854003906,
  illumination: 74.16666412353516,
  humidity: 40.303653717041016,
  acceleration_x: 11,
  acceleration_y: 29,
  acceleration_z: 862,
  gyroscope_x: -188,
  gyroscope_y: 22,
  gyroscope_z: -123,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8628768920898438,
  risk_level: 0,
  alarm_active: false,
  uptime: 3839,
  angle_x: 1.9457118511199951,
  angle_y: -0.754275143146515,
  angle_z: 2.0867979296418455
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:11:53.000Z',
  temperature: 31.707862854003906,
  humidity: 40.303653717041016,
  illumination: 74.16666412353516,
  acceleration_x: 11,
  acceleration_y: 29,
  acceleration_z: 862,
  gyroscope_x: -188,
  gyroscope_y: 22,
  gyroscope_z: -123,
  mpu_temperature: 31.707862854003906,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 862.557824148619,
  gyroscope_total: 225.73657213663896,
  risk_level: 0,
  alarm_active: false,
  uptime: 3839,
  angle_x: 1.9457118511199951,
  angle_y: -0.754275143146515,
  angle_z: 2.0867979296418455
}
🔄 处理 100 条历史数据...
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13437

⏱️  处理完成，耗时: 1277ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:12:23.579Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131223Z",
  "event_time_ms": "2025-07-18T13:12:23.417Z",
  "request_id": "c5fb26c6-d23e-4fd6-abe7-070985a1bcac",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.777297973632812,
            "illumination": 80.8333282470703,
            "humidity": 40.1129150390625,
            "acceleration_x": 7,
            "acceleration_y": 42,
            "acceleration_z": 865,
            "gyroscope_x": -185,
            "gyroscope_y": 25,
            "gyroscope_z": -125,
            "mpu_temperature": 31.777297973632812,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.866211771965027,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3870,
            "angle_x": 2.8433449268341064,
            "angle_y": -0.5012342929840088,
            "angle_z": 2.8871865525830556
          },
          "event_time": "20250718T131223Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.777297973632812,
  illumination: 80.8333282470703,
  humidity: 40.1129150390625,
  acceleration_x: 7,
  acceleration_y: 42,
  acceleration_z: 865,
  gyroscope_x: -185,
  gyroscope_y: 25,
  gyroscope_z: -125,
  mpu_temperature: 31.777297973632812,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.866211771965027,
  risk_level: 0,
  alarm_active: false,
  uptime: 3870,
  angle_x: 2.8433449268341064,
  angle_y: -0.5012342929840088,
  angle_z: 2.8871865525830556
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:12:23.000Z',
  temperature: 31.777297973632812,
  humidity: 40.1129150390625,
  illumination: 80.8333282470703,
  acceleration_x: 7,
  acceleration_y: 42,
  acceleration_z: 865,
  gyroscope_x: -185,
  gyroscope_y: 25,
  gyroscope_z: -125,
  mpu_temperature: 31.777297973632812,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.047342816777,
  gyroscope_total: 224.6664193866097,
  risk_level: 0,
  alarm_active: false,
  uptime: 3870,
  angle_x: 2.8433449268341064,
  angle_y: -0.5012342929840088,
  angle_z: 2.8871865525830556
}
✅ 数据插入成功
插入的记录ID: 13438

⏱️  处理完成，耗时: 409ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:12:53.791Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131253Z",
  "event_time_ms": "2025-07-18T13:12:53.639Z",
  "request_id": "747e2006-ffe7-45c4-9555-d6cf65bc33f3",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.820022583007812,
            "illumination": 74.16666412353516,
            "humidity": 40.45624542236328,
            "acceleration_x": 9,
            "acceleration_y": 33,
            "acceleration_z": 867,
            "gyroscope_x": -157,
            "gyroscope_y": 48,
            "gyroscope_z": -133,
            "mpu_temperature": 31.820022583007812,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.868257224559784,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3900,
            "angle_x": 2.223834276199341,
            "angle_y": -0.6126794815063477,
            "angle_z": 2.306689193423755
          },
          "event_time": "20250718T131253Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.820022583007812,
  illumination: 74.16666412353516,
  humidity: 40.45624542236328,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -157,
  gyroscope_y: 48,
  gyroscope_z: -133,
  mpu_temperature: 31.820022583007812,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.868257224559784,
  risk_level: 0,
  alarm_active: false,
  uptime: 3900,
  angle_x: 2.223834276199341,
  angle_y: -0.6126794815063477,
  angle_z: 2.306689193423755
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:12:53.000Z',
  temperature: 31.820022583007812,
  humidity: 40.45624542236328,
  illumination: 74.16666412353516,
  acceleration_x: 9,
  acceleration_y: 33,
  acceleration_z: 867,
  gyroscope_x: -157,
  gyroscope_y: 48,
  gyroscope_z: -133,
  mpu_temperature: 31.820022583007812,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 867.6744781310558,
  gyroscope_total: 211.28653530218153,
  risk_level: 0,
  alarm_active: false,
  uptime: 3900,
  angle_x: 2.223834276199341,
  angle_y: -0.6126794815063477,
  angle_z: 2.306689193423755
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13439

⏱️  处理完成，耗时: 522ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:13:24.119Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131323Z",
  "event_time_ms": "2025-07-18T13:13:23.963Z",
  "request_id": "66575e95-cbe5-4d18-abd8-99bf71ca96d2",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.902801513671875,
            "illumination": 69.16666412353516,
            "humidity": 40.326541900634766,
            "acceleration_x": 9,
            "acceleration_y": 34,
            "acceleration_z": 866,
            "gyroscope_x": -158,
            "gyroscope_y": 46,
            "gyroscope_z": -131,
            "mpu_temperature": 31.902801513671875,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8673107028007507,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3930,
            "angle_x": 2.2666139602661133,
            "angle_y": -0.6456499099731445,
            "angle_z": 2.3567780233024838
          },
          "event_time": "20250718T131323Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.902801513671875,
  illumination: 69.16666412353516,
  humidity: 40.326541900634766,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 46,
  gyroscope_z: -131,
  mpu_temperature: 31.902801513671875,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8673107028007507,
  risk_level: 0,
  alarm_active: false,
  uptime: 3930,
  angle_x: 2.2666139602661133,
  angle_y: -0.6456499099731445,
  angle_z: 2.3567780233024838
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:13:23.000Z',
  temperature: 31.902801513671875,
  humidity: 40.326541900634766,
  illumination: 69.16666412353516,
  acceleration_x: 9,
  acceleration_y: 34,
  acceleration_z: 866,
  gyroscope_x: -158,
  gyroscope_y: 46,
  gyroscope_z: -131,
  mpu_temperature: 31.902801513671875,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.713908968813,
  gyroscope_total: 210.33544637079123,
  risk_level: 0,
  alarm_active: false,
  uptime: 3930,
  angle_x: 2.2666139602661133,
  angle_y: -0.6456499099731445,
  angle_z: 2.3567780233024838
}
✅ 数据插入成功
插入的记录ID: 13440

⏱️  处理完成，耗时: 386ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

📨 收到新的IoT数据，开始处理...
✅ 历史数据处理完成，最新ID: 1600
🔍 检查设备离线状态...
=== 收到华为IoT数据 ===
时间: 2025-07-18T13:13:54.208Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131354Z",
  "event_time_ms": "2025-07-18T13:13:54.082Z",
  "request_id": "61e54567-fe31-49cf-8168-b86b8d5add97",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.889450073242188,
            "illumination": 75,
            "humidity": 40.61951446533203,
            "acceleration_x": 9,
            "acceleration_y": 35,
            "acceleration_z": 866,
            "gyroscope_x": -157,
            "gyroscope_y": 47,
            "gyroscope_z": -130,
            "mpu_temperature": 31.889450073242188,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.8671259880065918,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3960,
            "angle_x": 2.363966703414917,
            "angle_y": -0.645831823348999,
            "angle_z": 2.4505993795201784
          },
          "event_time": "20250718T131354Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.889450073242188,
  illumination: 75,
  humidity: 40.61951446533203,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -157,
  gyroscope_y: 47,
  gyroscope_z: -130,
  mpu_temperature: 31.889450073242188,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.8671259880065918,
  risk_level: 0,
  alarm_active: false,
  uptime: 3960,
  angle_x: 2.363966703414917,
  angle_y: -0.645831823348999,
  angle_z: 2.4505993795201784
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:13:54.000Z',
  temperature: 31.889450073242188,
  humidity: 40.61951446533203,
  illumination: 75,
  acceleration_x: 9,
  acceleration_y: 35,
  acceleration_z: 866,
  gyroscope_x: -157,
  gyroscope_y: 47,
  gyroscope_z: -130,
  mpu_temperature: 31.889450073242188,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 866.7537135772768,
  gyroscope_total: 209.1841294171238,
  risk_level: 0,
  alarm_active: false,
  uptime: 3960,
  angle_x: 2.363966703414917,
  angle_y: -0.645831823348999,
  angle_z: 2.4505993795201784
}
⚠️  发现 6 个离线设备
📵 设备离线: 兰草监测设备8 (77035712) (179836分钟)
📵 设备离线: 上坪监测设备16 (vice_006) (179198分钟)
📵 设备离线: 下湾监测设备8 (vice_007) (179193分钟)
📵 设备离线: 前岗监测设备8 (vice_008) (179188分钟)
📵 设备离线: 上坪监测设备17 (t_device) (69037分钟)
📵 设备离线: 龙门滑坡监测站 (45分钟)
📨 收到新的IoT数据，开始处理...
🔄 处理 100 条历史数据...
✅ 数据插入成功
插入的记录ID: 13441

⏱️  处理完成，耗时: 2306ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

=== 收到华为IoT数据 ===
时间: 2025-07-18T13:14:24.396Z
数据: {
  "resource": "device.property",
  "event": "report",
  "event_time": "20250718T131424Z",
  "event_time_ms": "2025-07-18T13:14:24.218Z",
  "request_id": "75cc87f6-3f57-451c-86dd-4df169f1c772",
  "notify_data": {
    "header": {
      "app_id": "4eec73d3b77343f38262e8d3dffe81c5",
      "device_id": "6815a14f9314d118511807c6_rk2206",
      "node_id": "rk2206",
      "product_id": "6815a14f9314d118511807c6",
      "gateway_id": "6815a14f9314d118511807c6_rk2206"
    },
    "body": {
      "services": [
        {
          "service_id": "smartHome",
          "properties": {
            "temperature": 31.932174682617188,
            "illumination": 75,
            "humidity": 40.56916046142578,
            "acceleration_x": 8,
            "acceleration_y": 34,
            "acceleration_z": 865,
            "gyroscope_x": -151,
            "gyroscope_y": 51,
            "gyroscope_z": -128,
            "mpu_temperature": 31.932174682617188,
            "latitude": 22.817,
            "longitude": 108.3669,
            "vibration": 0.866690456867218,
            "risk_level": 0,
            "alarm_active": false,
            "uptime": 3990,
            "angle_x": 2.276313066482544,
            "angle_y": -0.5491955876350403,
            "angle_z": 2.34162699209694
          },
          "event_time": "20250718T131424Z"
        }
      ]
    }
  }
}
📱 设备ID: 6815a14f9314d118511807c6_rk2206
📦 产品ID: 6815a14f9314d118511807c6
🔧 服务数量: 1

🔄 处理服务: smartHome
属性数据: {
  temperature: 31.932174682617188,
  illumination: 75,
  humidity: 40.56916046142578,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -151,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.932174682617188,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0.866690456867218,
  risk_level: 0,
  alarm_active: false,
  uptime: 3990,
  angle_x: 2.276313066482544,
  angle_y: -0.5491955876350403,
  angle_z: 2.34162699209694
}
📝 准备插入数据: {
  device_id: 'device_1',
  event_time: '2025-07-18T13:14:24.000Z',
  temperature: 31.932174682617188,
  humidity: 40.56916046142578,
  illumination: 75,
  acceleration_x: 8,
  acceleration_y: 34,
  acceleration_z: 865,
  gyroscope_x: -151,
  gyroscope_y: 51,
  gyroscope_z: -128,
  mpu_temperature: 31.932174682617188,
  latitude: 22.817,
  longitude: 108.3669,
  vibration: 0,
  acceleration_total: 865.7049150836559,
  gyroscope_total: 204.41624201613726,
  risk_level: 0,
  alarm_active: false,
  uptime: 3990,
  angle_x: 2.276313066482544,
  angle_y: -0.5491955876350403,
  angle_z: 2.34162699209694
}
📨 收到新的IoT数据，开始处理...
✅ 数据插入成功
插入的记录ID: 13442

⏱️  处理完成，耗时: 636ms
✅ 成功处理: 1/1 个服务
=== 处理结束 ===

